- [1. 卡方分布与卡方检验](#1-卡方分布与卡方检验)
  - [1.1. 1.卡方分布](#11-1卡方分布)
  - [1.2. 2.卡方检验](#12-2卡方检验)
  - [1.3. 3.卡方检验做特征选择](#13-3卡方检验做特征选择)


## 1. 卡方分布与卡方检验

### 1.1. 1.卡方分布

卡方分布(**chi-square distribution**, χ2-distribution)是概率统计里常用的一种概率分布，也是统计推断里应用最广泛的概率分布之一，在假设检验与置信区间的计算中经常能见到卡方分布的身影。

我们先来看看卡方分布的定义：

**若k个独立的随机变量Z1,Z2,⋯,Zk，且符合标准正态分布N(0,1)，则这k个随机变量的平方和**

**X=∑<sub>i=1~k</sub>Z<sup>2</sup><sub>i</sub>**

**为服从自由度为k的卡方分布**，记为：

**X∼χ2(k)**

也可以记为：

**X∼χ2k**

卡方分布的期望与方差分别为：

**E(χ2)=n，D(χ2)=2n**，其中**n为卡方分布的自由度**。





### 1.2. 2.卡方检验

χ2检验是以χ2分布为基础的一种假设检验方法，主要用于分类变量。其基本思想是**根据样本数据推断总体的分布与期望分布是否有显著性差异，或者推断两个分类变量是否相关或者独立**。

**一般可以设原假设为 H0：观察频数与期望频数没有差异，或者两个变量相互独立不相关**。

实际应用中，我们**先假设H0成立，计算出χ2的值，χ2表示观察值与理论值之间的偏离程度**。根据χ2分布，χ2统计量以及自由度，**可以确定在H0成立的情况下获得当前统计量以及更极端情况的概率p。如果p很小，说明观察值与理论值的偏离程度大，应该拒绝原假设**。否则不能拒绝原假设。


χ2的计算公式为：


![img](http://img.uwayfly.com/article_mike_20200612215932_3155f667a6a0.png)


其中，**A为实际值，T为理论值**。

χ2用于衡量实际值与理论值的差异程度，这也是卡方检验的核心思想。χ2包含了以下两个信息：

1. **实际值与理论值偏差的绝对大小**。
2. **差异程度与理论值的相对大小**。


### 1.3. 3.卡方检验做特征选择

卡方检验经常被用来做特征选择。举个网络上的例子，**假设我们有一堆新闻标题，需要判断标题中包含某个词（比如吴亦凡）是否与该条新闻的类别归属（比如娱乐）是否有关**，我们只需要简单统计就可以获得这样的一个四格表：

![img](http://img.uwayfly.com/article_mike_20200612220257_6f4f61b92d79.png)



通过这个四格表我们得到的第一个信息是：标题是否包含吴亦凡确实对新闻是否属于娱乐有统计上的差别，包含吴亦凡的新闻属于娱乐的比例更高，但我们还无法排除这个差别是否由于抽样误差导致。

那么**首先假设标题是否包含吴亦凡与新闻是否属于娱乐是独立无关的**，**随机抽取一条新闻标题，属于娱乐类别的概率是：(19 + 34) / (19 + 34 + 24 +10) = 60.9%**



理论值的四格表为：

![img](http://img.uwayfly.com/article_mike_20200612220319_26c9f73ced6f.png)



显然，**如果两个变量是独立无关的，那么四格表中的理论值与实际值的差异会非常小**。

则χ2值为:

![img](http://img.uwayfly.com/article_mike_20200612220356_3d6db1f92f87.png)



标准的四格表χ2值可以用以下方式进行计算：

![img](http://img.uwayfly.com/article_mike_20200612220409_c68626a12d50.png)



其中，N=A+B+C+D

得到χ2的值以后，怎样可以得知无关性假设是否可靠？接下来我们应该**查询卡方分布的临界值表了。**

首先我们明确自由度的概念：**自由度v=(行数-1)*(列数-1)**。

然后看卡方分布的临界概率，表如下：

![img](http://img.uwayfly.com/article_mike_20200612220820_baaf298b95e7.png)



**一般我们取p=0.05，也就是说两者不相关的概率为0.05时，对应的卡方值为3.84**。**显然10.0>3.84，那就说明包含吴亦凡的新闻不属于娱乐的概率小于0.05。换句话说，包含吴亦凡的新闻与娱乐新闻相关的概率大于95%！**



总结一下：我们可以通过卡方值来判断特征是否与类型有关。**卡方值越大，说明关联越强，特征越需要保留。卡方值越小，说明越不相关，特征需要去除**。