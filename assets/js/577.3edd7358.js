(window.webpackJsonp=window.webpackJsonp||[]).push([[577],{850:function(t,s,a){"use strict";a.r(s);var e=a(14),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"全局消息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全局消息"}},[t._v("#")]),t._v(" 全局消息")]),t._v(" "),s("p",[t._v("是否显示一个全局消息弹窗，取决于4个因素：")]),t._v(" "),s("ol",[s("li",[t._v("是否有新消息进来，没有不显示")]),t._v(" "),s("li",[t._v("用户是否点击了x，点击后不显示")]),t._v(" "),s("li",[t._v("props中传入的是否显示，有些页面不需要显示")]),t._v(" "),s("li",[t._v("未读消息总数是否大于0，这个因素不考虑的话，消息框会先闪烁后消失")])]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("realIsShowMsg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" hasRobotNewMsg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" showRobotMsg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" isShowMsg "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" hasRobotNewMsg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" showRobotMsg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" isShowMsg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("h2",{attrs:{id:"消息传递流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#消息传递流程"}},[t._v("#")]),t._v(" 消息传递流程")]),t._v(" "),s("p",[t._v("普通页面(比如message-center)mixin-mounted，监听uid，登录tim，监听回调，给到vuex")]),t._v(" "),s("p",[t._v("header 从 vuex 中取，去到其他页面，还是从 vuex 中取，不影响。不要直接引入 IMHander，要解耦")]),t._v(" "),s("h2",{attrs:{id:"tim-js-sdk登录失败"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tim-js-sdk登录失败"}},[t._v("#")]),t._v(" tim-js-sdk登录失败")]),t._v(" "),s("p",[t._v("在 iOS15 和 iOS16 上，"),s("code",[t._v("tim-js-sdk")]),t._v("压缩有问题，所以不会开启压缩。")]),t._v(" "),s("p",[t._v("如果某些自研浏览器在上述版本下的"),s("code",[t._v("userAgent")]),t._v("不正确，比如本来系统是 iOS16，"),s("code",[t._v("userAgent")]),t._v("却给出了12，那么"),s("code",[t._v("tim-js-sdk")]),t._v("就会压缩，导致登录失败。")]),t._v(" "),s("p",[t._v("解决办法，就是强制指定"),s("code",[t._v("userAgent")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 修改ua ")]),t._v("\nnavigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__defineGetter__")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'userAgent'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'My custom user agent'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"dev机器中文乱码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dev机器中文乱码"}},[t._v("#")]),t._v(" Dev机器中文乱码")]),t._v(" "),s("p",[t._v("（1）打开系统配置文件：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /etc/profile\n")])])]),s("p",[t._v("在文件末尾添加：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("LANG")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zh_CN.UTF-8"')]),t._v("\n")])])]),s("p",[t._v("（2）执行以下命令立即生效：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /etc/profile\n")])])]),s("p",[t._v("（3）使用"),s("code",[t._v("echo $LANG")]),t._v("命令打印环境变量，可以看到已设置为"),s("code",[t._v("zh_CN.UTF-8")])]),t._v(" "),s("h2",{attrs:{id:"vue-router-的history模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-router-的history模式"}},[t._v("#")]),t._v(" Vue Router 的history模式")]),t._v(" "),s("p",[t._v("Vue Router 在 history 模式下提示 "),s("code",[t._v("Uncaught SyntaxError: Unexpected token ＞")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("vue-cli3.0下：在"),s("code",[t._v("vue.config")]),t._v("里设置"),s("code",[t._v("publicPath: '/'")])])]),t._v(" "),s("li",[s("p",[t._v("vue-cli2.x下：在"),s("code",[t._v("config/index")]),t._v("里设置"),s("code",[t._v("assetsPublicPath: '/'")])])])]),t._v(" "),s("p",[t._v("参考：https://blog.csdn.net/qq_35559000/article/details/117824321")])])}),[],!1,null,null,null);s.default=n.exports}}]);