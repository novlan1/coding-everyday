(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{441:function(t,s,a){"use strict";a.r(s);var e=a(25),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("ul",[s("li",[s("a",{attrs:{href:"#1-babel%E5%B7%A5%E4%BD%9C%E6%B5%81"}},[t._v("1. babel工作流")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#11-ast"}},[t._v("1.1. AST")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#12-babel-%E5%A4%A7%E6%A6%82%E5%88%86%E4%B8%BA%E4%B8%89%E5%A4%A7%E9%83%A8%E5%88%86"}},[t._v("1.2. Babel 大概分为三大部分:")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#121-%E6%96%87%E6%9C%AC-----ast%E8%A7%A3%E6%9E%90%E7%9A%84%E8%BF%87%E7%A8%8B%E4%B8%AD%E6%9C%89%E4%B8%A4%E4%B8%AA%E5%85%B3%E9%94%AE%E6%AD%A5%E9%AA%A4"}},[t._v("1.2.1. "),s("code",[t._v("文本 ---\x3e AST")]),t._v("(解析)的过程中有两个关键步骤:")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#122-%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90tokenizer----%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8"}},[t._v("1.2.2. 词法分析(Tokenizer -- 词法分析器)")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#123-%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90"}},[t._v("1.2.3. 语法分析")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#13-%E5%A6%82%E4%BD%95%E8%BD%AC%E6%8D%A2%E4%BB%A3%E7%A0%81"}},[t._v("1.3. 如何转换代码?")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#2-toolings"}},[t._v("2. Toolings")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#3-plugins"}},[t._v("3. Plugins")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#4-presets"}},[t._v("4. Presets")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#5-polyfills"}},[t._v("5. Polyfills")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#6-babel7%E5%81%9A%E7%9A%84%E6%9B%B4%E6%96%B0"}},[t._v("6. babel7做的更新")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#7-babel%E5%B0%86ecmascript-2015-%E7%89%88%E6%9C%AC%E7%9A%84%E4%BB%A3%E7%A0%81%E5%88%86%E4%B8%BA%E4%BA%86%E4%B8%A4%E7%A7%8D%E6%83%85%E5%86%B5%E5%A4%84%E7%90%86"}},[t._v("7. babel将"),s("code",[t._v("ECMAScript 2015+")]),t._v(" 版本的代码分为了两种情况处理：")])])]),t._v(" "),s("h3",{attrs:{id:"_1-babel工作流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-babel工作流"}},[t._v("#")]),t._v(" 1. babel工作流")]),t._v(" "),s("div",{staticClass:"language-rust extra-class"},[s("pre",{pre:!0,attrs:{class:"language-rust"}},[s("code",[t._v("输入字符串 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("@")]),t._v("babel"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("parser parser "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("AST")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("->")]),t._v(" transformer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("AST")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("@")]),t._v("babel"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("generator "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("->")]),t._v(" 输出字符串\n")])])]),s("h4",{attrs:{id:"_1-1-ast"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-ast"}},[t._v("#")]),t._v(" 1.1. AST")]),t._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[t._v("抽象语法树（"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("abstract")]),t._v(" syntax tree或者缩写为AST），或者语法树（syntax tree），是源代码的抽象语法结构的树状表现形式，这里特指编程语言的源代码。\n\n和抽象语法树相对的是具体语法树（concrete syntaxtree），通常称作分析树（parse tree）。\n\n一般的，在源代码的翻译和编译过程中，语法分析器创建出分析树。一旦AST被创建出来，在后续的处理过程中，比如语义分析阶段，会添加一些信息。\n")])])]),s("ol",[s("li",[s("a",{attrs:{href:"http://esprima.org/demo/parse.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("AST示例"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://astexplorer.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("AST Explorer"),s("OutboundLink")],1)])]),t._v(" "),s("h4",{attrs:{id:"_1-2-babel-大概分为三大部分"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-babel-大概分为三大部分"}},[t._v("#")]),t._v(" 1.2. Babel 大概分为三大部分:")]),t._v(" "),s("ol",[s("li",[t._v("解析: 将代码(其实就是字符串)转换成 "),s("code",[t._v("AST")]),t._v("( 抽象语法树)")]),t._v(" "),s("li",[t._v("转换: 访问 "),s("code",[t._v("AST")]),t._v(" 的节点进行变换操作生成新的 "),s("code",[t._v("AST")])]),t._v(" "),s("li",[t._v("生成: 以新的 "),s("code",[t._v("AST")]),t._v(" 为基础生成代码")])]),t._v(" "),s("h5",{attrs:{id:"_1-2-1-文本-ast-解析-的过程中有两个关键步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-文本-ast-解析-的过程中有两个关键步骤"}},[t._v("#")]),t._v(" 1.2.1. "),s("code",[t._v("文本 ---\x3e AST")]),t._v("(解析)的过程中有两个关键步骤:")]),t._v(" "),s("ol",[s("li",[t._v("词法分析: 将代码(字符串)分割为 "),s("code",[t._v("token")]),t._v(" 流，即语法单元成的数组")]),t._v(" "),s("li",[t._v("语法分析: 分析 "),s("code",[t._v("token")]),t._v(" 流(上面生成的数组)并生成 "),s("code",[t._v("AST")])])]),t._v(" "),s("h5",{attrs:{id:"_1-2-2-词法分析-tokenizer-词法分析器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-词法分析-tokenizer-词法分析器"}},[t._v("#")]),t._v(" 1.2.2. 词法分析(Tokenizer -- 词法分析器)")]),t._v(" "),s("p",[t._v("要做词法分析,首先我们需要明白在 JavaScript 中哪些属于语法单元")]),t._v(" "),s("ul",[s("li",[t._v("数字：JavaScript 中的科学记数法以及普通数组都属于语法单元.")]),t._v(" "),s("li",[t._v("括号："),s("code",[t._v("()")]),t._v("只要出现,不管任何意义都算是语法单元")]),t._v(" "),s("li",[t._v("标识符：连续字符,常见的有变量,常量(例如: null true)，关键字(if break)等等")]),t._v(" "),s("li",[t._v("运算符："),s("code",[t._v("+、-、*、/")]),t._v("等等")]),t._v(" "),s("li",[t._v("当然还有注释,中括号等")])]),t._v(" "),s("blockquote",[s("p",[t._v("在我们 parser 的过程中,应该换一个角度看待代码,我们平时工作用的代码.本质是就是字符串或者一段文本,它没有任何意义,是 JavaScript 引擎赋予了它意义,所以我们在解析过程中代码只是一段字符串.")])]),t._v(" "),s("h5",{attrs:{id:"_1-2-3-语法分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3-语法分析"}},[t._v("#")]),t._v(" 1.2.3. 语法分析")]),t._v(" "),s("p",[t._v("语法分析要比词法分析复杂得多")]),t._v(" "),s("h4",{attrs:{id:"_1-3-如何转换代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-如何转换代码"}},[t._v("#")]),t._v(" 1.3. 如何转换代码?")]),t._v(" "),s("p",[t._v("在 Babel 中我们使用者最常使用的地方就是代码转换，大家常用的 Babel 插件就是定义代码转换规则而生的，而代码解析和生成这一头一尾都主要是 Babel 负责。")]),t._v(" "),s("p",[t._v("前端可以利用编译原理相关的东西还有很多，除了我们常见的es6转换工具 "),s("code",[t._v("babel")]),t._v("，代码检测的 "),s("code",[t._v("eslint")]),t._v("等等。")]),t._v(" "),s("h3",{attrs:{id:"_2-toolings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-toolings"}},[t._v("#")]),t._v(" 2. Toolings")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("@babel/parser")]),t._v(" 将源代码解析成 AST。")]),t._v(" "),s("li",[s("code",[t._v("@babel/generator")]),t._v(" 将AST解码生 js代码。")]),t._v(" "),s("li",[s("code",[t._v("@babel/core")]),t._v(" 包括了整个babel工作流，也就是说在@babel/core里面我们会使用到"),s("code",[t._v("@babel/parser")]),t._v("、"),s("code",[t._v("transformer[s]")]),t._v("、以及"),s("code",[t._v("@babel/generator")]),t._v("。")]),t._v(" "),s("li",[s("code",[t._v("@babel/code-frame")]),t._v(" 用于生成错误信息并且打印出错误原因和错误行数。（其实就是个console工具类）")]),t._v(" "),s("li",[s("code",[t._v("@babel/helpers")]),t._v(" 也是工具类，提供了一些内置的函数实现，主要用于babel插件的开发。")]),t._v(" "),s("li",[s("code",[t._v("@babel/runtime")]),t._v(" 也是工具类，但是是为了babel编译时提供一些基础工具库。作用于"),s("code",[t._v("transformer[s]")]),t._v("阶段，当然这是一个工具库，如果要使用这个工具库，还需要引入"),s("code",[t._v("@babel/plugin-transform-runtime")]),t._v("，它才是"),s("code",[t._v("transformer[s]")]),t._v("阶段里面的主角。")]),t._v(" "),s("li",[s("code",[t._v("@babel/template")]),t._v(" 也是工具类，主要用途是为"),s("code",[t._v("parser")]),t._v("提供模板引擎，更加快速的转化成AST")]),t._v(" "),s("li",[s("code",[t._v("@babel/traverse")]),t._v(" 也是工具类，主要用途是来便利AST树，也就是在"),s("code",[t._v("@babel/generator")]),t._v("过程中生效。")]),t._v(" "),s("li",[s("code",[t._v("@babel/types")]),t._v(" 也是工具类，主要用途是在创建AST的过程中判断各种语法的类型。")])]),t._v(" "),s("p",[t._v("通过了解这每一个工具的用途 我们对前面简略的工作流坐下填充。")]),t._v(" "),s("div",{staticClass:"language-dart extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dart"}},[s("code",[s("span",{pre:!0,attrs:{class:"token metadata function"}},[t._v("@babel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("code"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("frame 为全局错误捕获工具类\n\n"),s("span",{pre:!0,attrs:{class:"token metadata function"}},[t._v("@babel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("core\n├── 输入字符串\n├── "),s("span",{pre:!0,attrs:{class:"token metadata function"}},[t._v("@babel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("parser\n│   └── "),s("span",{pre:!0,attrs:{class:"token metadata function"}},[t._v("@babel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("template\n│       └── "),s("span",{pre:!0,attrs:{class:"token metadata function"}},[t._v("@babel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("types\n├── AST\n├── transformer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n│   └── "),s("span",{pre:!0,attrs:{class:"token metadata function"}},[t._v("@babel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("helpers\n├── AST\n├── "),s("span",{pre:!0,attrs:{class:"token metadata function"}},[t._v("@babel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("generator\n│   └── "),s("span",{pre:!0,attrs:{class:"token metadata function"}},[t._v("@babel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("traverse\n")])])]),s("h3",{attrs:{id:"_3-plugins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-plugins"}},[t._v("#")]),t._v(" 3. Plugins")]),t._v(" "),s("p",[t._v("每一个Plugin处理自己的一种AST Type语法。\n重点讲一下"),s("code",[t._v("@babel/plugin-transform-runtime")]),t._v("，用来解析"),s("code",[t._v("@babel/runtime")]),t._v("工具类内的函数")]),t._v(" "),s("p",[s("code",[t._v("core-js")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"plugins"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/plugin-transform-runtime"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"corejs"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//是否启用corejs https://babeljs.io/docs/en/babel-plugin-transform-runtime#corejs")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"helpers"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 各种辅助函数")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"regenerator"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 启用generator 支持async await")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"useESModules"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("a",{attrs:{href:"https://babeljs.io/docs/en/plugins",target:"_blank",rel:"noopener noreferrer"}},[t._v("Plugins List"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"_4-presets"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-presets"}},[t._v("#")]),t._v(" 4. Presets")]),t._v(" "),s("p",[t._v("而Presets可能理解起来更为简单，翻译过来是预设的意思，他几乎就是一个"),s("code",[t._v("Plugins")]),t._v("数组和配置的集合。")]),t._v(" "),s("p",[s("code",[t._v("@babel/preset-env")]),t._v(" 重点讲一下，他是以前es2015、es2016和es2017的集合。需要注意的是"),s("code",[t._v("@babel/preset-env")]),t._v("不支持所有在"),s("code",[t._v("stage-x")]),t._v("的plugin。"),s("a",{attrs:{href:"https://github.com/browserslist/browserslist",target:"_blank",rel:"noopener noreferrer"}},[t._v("browserslist"),s("OutboundLink")],1),t._v(" 会和"),s("code",[t._v("caniuse")]),t._v("数据结合来判断当前语法是否需要转换。target属性完全按照 browserslist 规则实现。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"presets"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"env"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"targets"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 目标环境")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"browsers"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 浏览器")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"last 2 versions"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ie >= 10"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"node"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"current"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// node")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"modules"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否转译module syntax，默认是 commonjs")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"debug"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否输出启用的plugins列表")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"spec"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否允许more spec compliant，但可能转译出的代码更慢https://babeljs.io/docs/en/babel-preset-env#spec")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"loose"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否允许生成更简单es5的代码，但可能不那么完全符合ES6语义")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"useBuiltIns"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// 怎么运用 polyfill"usage" | "entry" | false 测试了一下 usage的包最小')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"include"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 总是启用的 plugins")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"exclude"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 强制不启用的 plugins")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"forceAllTransforms"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 强制使用所有的plugins，用于只能支持ES5的uglify可以正确压缩代码")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"configPath"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//browserslist的路径")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"ignoreBrowserslistConfig"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//是否忽略browserslist的配置")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("useBuiltIns: 'usage' 按需加载，实验性")]),t._v(" "),s("div",{staticClass:"language-jsx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-jsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// input")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// a.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" b "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// b.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// output")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// a.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"core-js/modules/es6.promise"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// b.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"core-js/modules/es6.map"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" b "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("useBuiltIns: 'entry'")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// input")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/polyfill"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// output")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"core-js/modules/es7.string.pad-start"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"core-js/modules/es7.string.pad-end"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("useBuiltIns: false\n解释为不使用polyfill。\n其他presets列表")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("stage"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nstage"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nstage"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nstage"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\nflow\nreact\ntypescript\nminify  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//比较鸡肋的压缩preset 我也不知道为什么放在presets里面 我觉得他更应该是一个plugin。当然看名字也看的出来babel-preset-minify 这个模块并没有在这次升级中被移到@babel的私有域下。")]),t._v("\n")])])]),s("h3",{attrs:{id:"_5-polyfills"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-polyfills"}},[t._v("#")]),t._v(" 5. Polyfills")]),t._v(" "),s("p",[s("code",[t._v("@babel/polyfill")]),t._v("和"),s("code",[t._v("runtime")]),t._v("的差别")]),t._v(" "),s("p",[s("code",[t._v("runtime")]),t._v("提供的其实是一个工具类合集，例如 _extend，是为了减少编译时产生的冗余代码，它不包括所有新的es API比如Set Map Promise等。")]),t._v(" "),s("p",[t._v("而polyfill则是用来提供上述的新的ES API，其中也包括了Array.form Object.assign等新增的原型方法。")]),t._v(" "),s("p",[t._v("使用方法\nhttps://babeljs.io/docs/en/babel-polyfill#usage-in-node-browserify-webpack")]),t._v(" "),s("h3",{attrs:{id:"_6-babel7做的更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-babel7做的更新"}},[t._v("#")]),t._v(" 6. babel7做的更新")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("babel7")]),t._v("的"),s("code",[t._v("npm")]),t._v("包正式更名为"),s("code",[t._v("@babel/core")]),t._v("、"),s("code",[t._v("@babel/cli")]),t._v("等。")]),t._v(" "),s("li",[s("code",[t._v("babel7")]),t._v("不在支持"),s("code",[t._v("Node.js")]),t._v(" "),s("code",[t._v("0.10")]),t._v(", "),s("code",[t._v("0.12")]),t._v(", "),s("code",[t._v("4")]),t._v(" 和 "),s("code",[t._v("5")]),t._v("版本。")]),t._v(" "),s("li",[s("code",[t._v("babel7")]),t._v("移除了"),s("code",[t._v("@babel/polyfill")]),t._v("内的"),s("code",[t._v("polyfills")]),t._v("支持，现在"),s("code",[t._v("@babel/polyfill")]),t._v("几乎只是"),s("code",[t._v("core-js")]),t._v(" "),s("code",[t._v("v2")]),t._v("的映射。")]),t._v(" "),s("li",[s("code",[t._v("babylon")]),t._v("现在被重命名为"),s("code",[t._v("@babel/parser")])]),t._v(" "),s("li",[t._v("去除包名上的年份。")]),t._v(" "),s("li",[t._v("将"),s("code",[t._v("react")]),t._v("和"),s("code",[t._v("flow")]),t._v("预设分离。")])]),t._v(" "),s("h3",{attrs:{id:"_7-babel将ecmascript-2015-版本的代码分为了两种情况处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-babel将ecmascript-2015-版本的代码分为了两种情况处理"}},[t._v("#")]),t._v(" 7. babel将"),s("code",[t._v("ECMAScript 2015+")]),t._v(" 版本的代码分为了两种情况处理：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("语法层")]),t._v("： let、const、class、箭头函数等，这些需要在"),s("strong",[t._v("构建时进行转译")]),t._v("，是指在语法层面上的转译")]),t._v(" "),s("li",[s("strong",[t._v("api方法层")]),t._v("：Promise、includes、map等，这些是在全局或者Object、Array等的原型上新增的方法，它们可以由相应es5的方式重新定义")])]),t._v(" "),s("p",[t._v("参考资料：")]),t._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"https://www.jianshu.com/p/9aaa99762a52",target:"_blank",rel:"noopener noreferrer"}},[t._v("babel入门到精通"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.cnblogs.com/duxinyi/p/11576583.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("面试官: 聊一聊Babel"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://segmentfault.com/a/1190000023077637",target:"_blank",rel:"noopener noreferrer"}},[t._v("用了babel还需要polyfill吗？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://juejin.im/post/6844904132294213639",target:"_blank",rel:"noopener noreferrer"}},[t._v("带你一步一步配置Babel7"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);