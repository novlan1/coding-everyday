(window.webpackJsonp=window.webpackJsonp||[]).push([[580],{850:function(v,_,t){"use strict";t.r(_);var o=t(14),a=Object(o.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h2",{attrs:{id:"背景"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[v._v("#")]),v._v(" 背景")]),v._v(" "),_("p",[v._v("和平横版之前是在 hp-match/dzs-match2 中，为了方便组件和逻辑复用，需要尽早迁移到 dzs-match 这个主工程中，避免维护两套。")]),v._v(" "),_("p",[v._v("目标架构：")]),v._v(" "),_("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2024/4/own_mike_63a4fb022e85254fb0.png",width:"500"}}),v._v(" "),_("h2",{attrs:{id:"迁移方法"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#迁移方法"}},[v._v("#")]),v._v(" 迁移方法")]),v._v(" "),_("p",[v._v("采用脚本迁移。好处是：")]),v._v(" "),_("ol",[_("li",[v._v("工作量小")]),v._v(" "),_("li",[v._v("减少出错")])]),v._v(" "),_("p",[v._v("脚本迁移策略：")]),v._v(" "),_("ol",[_("li",[v._v("对于公共目录，如 "),_("code",[v._v("src/local-component")]),v._v(", "),_("code",[v._v("src/local-logic")]),v._v("，先查找之前是否存在，如不存在则直接复制，如存在但文件内容不相同，则新建对应的"),_("code",[v._v("-gp-hor")]),v._v("文件夹，进行复制，如存在且该目录下所有文件内容相同，则略过")]),v._v(" "),_("li",[v._v("新建 "),_("code",[v._v("gp-hor")]),v._v(" 子工程，对之前的子工程进行拷贝")]),v._v(" "),_("li",[v._v("记录下所有路径变化的文件，包括 "),_("code",[v._v("x-gp-hor")]),v._v(" 的公共组件、逻辑，也包括 "),_("code",[v._v("gp-hor")]),v._v(" 子工程下的文件，生成新旧文件映射")]),v._v(" "),_("li",[v._v("对复制的所有文件的引入路径，根据映射关系进行替换")])]),v._v(" "),_("p",[v._v("迁移后的工作量")]),v._v(" "),_("ol",[_("li",[v._v("新建 "),_("code",[v._v("pages.json")]),v._v("、"),_("code",[v._v("manifest.json")]),v._v("，uni-app 项目没有这两文件跑不起来")]),v._v(" "),_("li",[_("code",[v._v("pages.json")]),v._v(" 只需要入口，其他页面路由还是从 "),_("code",[v._v("router.js")]),v._v(" 中传给 "),_("code",[v._v("uni-simple-router")])]),v._v(" "),_("li",[_("code",[v._v("babel.config.js")]),v._v(" 中支持 "),_("code",[v._v("vant")]),v._v(" 的按需引入")]),v._v(" "),_("li",[v._v("其他适配，比如 "),_("code",[v._v("input")]),v._v(" 样式")])]),v._v(" "),_("p",[v._v("工程内的适配工作较小，目前发现：")]),v._v(" "),_("ol",[_("li",[v._v("之前的做的乱七八糟的 ts 组件，各种 this as any，在编译期报错，需改回 js")]),v._v(" "),_("li",[v._v("input、textarea 等元素被 uni-app 包装重写，需要样式更新")]),v._v(" "),_("li",[v._v("样式穿透由 >>> 改成 ::v-deep")])]),v._v(" "),_("h2",{attrs:{id:"后续规划"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#后续规划"}},[v._v("#")]),v._v(" 后续规划")]),v._v(" "),_("p",[v._v("当前阶段只是完成迁移，仍有一部分重复的代码，后面跟随需求重构。")]),v._v(" "),_("p",[v._v("后续，横竖版公用的逻辑、组件分别放到 "),_("code",[v._v("local-logic")]),v._v("、"),_("code",[v._v("local-component")]),v._v("中，核心组件、逻辑下沉到 "),_("code",[v._v("press-plus")]),v._v(" 中。")]),v._v(" "),_("h2",{attrs:{id:"测试分支及测试链接"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#测试分支及测试链接"}},[v._v("#")]),v._v(" 测试分支及测试链接")]),v._v(" "),_("p",[v._v("见群公告。")])])}),[],!1,null,null,null);_.default=a.exports}}]);