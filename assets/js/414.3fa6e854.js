(window.webpackJsonp=window.webpackJsonp||[]).push([[414],{718:function(e,n,t){"use strict";t.r(n);var i=t(25),r=Object(i.a)({},(function(){var e=this,n=e._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("p",[e._v("é—®é¢˜èƒŒæ™¯\nè¡¨å•å‚æ•°ä¸­æœ‰å•ä¸ªå­—æ®µï¼ˆéœ€è¦æ ¡éªŒæ˜¯å¦å­˜åœ¨ã€æ˜¯å¦åˆæ³•ï¼‰ï¼Œä¹Ÿæœ‰æ•°ç»„å¯¹è±¡å­—æ®µï¼ˆæ•°ç»„ä¸­æ¯ä¸ªå¯¹è±¡éœ€è¦éªŒè¯é‡Œé¢çš„å±æ€§æ˜¯å¦å­˜åœ¨ï¼ŒåŒæ—¶è¿˜æœ‰æ—¶é—´æ ¼å¼ã€æ•°å€¼åŒºé—´æ ¼å¼ã€å­—ç¬¦ä¸²æ ¼å¼çš„æ ¡éªŒä»¥åŠå„ç§å¤§å°é™åˆ¶ï¼‰ï¼Œéœ€è¦åœ¨å‘ POST è¯·æ±‚å‰å¯¹æ‰€æœ‰å‚æ•°åšæ ¡éªŒã€‚")]),e._v(" "),n("p",[e._v("æœ¬æ–‡ç»“å°¾æœ‰è¡¨å•å‚æ•°ç»“æ„ä»¥åŠé‡æ„å‰å¤§é‡çš„ if-else ï¼Œå¯ä»¥æ„Ÿå—ä¸‹ï¼Œå·²ç»ç®—å¾ˆå¤æ‚çš„äº†ã€‚")]),e._v(" "),n("p",[e._v("è°ƒç ”é˜¶æ®µ\nä»å®è§‚æ–¹é¢æ¥è®²å…¶å®æ˜¯ç®€åŒ– if-else çš„å¤æ‚åº¦ï¼ŒæŠ½ç¦»å‡ºå…¬å…±é€»è¾‘ï¼Œå¯¹ä¸åŒæƒ…å†µè¿›è¡Œåˆç†å°è£…ï¼Œæé«˜ä»£ç å¯è¯»æ€§ã€‚æ‰€ä»¥æˆ‘ä»å¤šä¸ªæ¸ é“æ”¶é›†åˆ°å¯¹äº if-else åµŒå¥—çš„è§£å†³æ–¹æ¡ˆï¼Œæ€»ç»“å‡ºå¦‚ä¸‹ï¼š")]),e._v(" "),n("p",[e._v("lookupï¼ˆæŸ¥æ‰¾è¡¨ï¼‰\nåˆ†ç¦»æ•°æ®é…ç½®ä¸ä¸šåŠ¡é€»è¾‘ï¼Œç®€å•æ¥è¯´å°±æ˜¯è°ƒç”¨ä¸¤è€…é—´çš„æ˜ å°„å…³ç³»æ¥å®ç°éœ€æ±‚ï¼Œä»¥é“¶è¡Œä¿¡ç”¨çš„ç¤ºä¾‹æ¥è¯´æ˜ï¼š")]),e._v(" "),n("p",[e._v("function showGrace(grace,level,levelForGrace) {\nfor(let i=0;i<level.length;i++){\nif(grace>=level[i]){\nreturn levelForGrace[i];\n}\n}\n//å¦‚æœä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°±æ˜¯åˆ†æ•°å¾ˆä½ï¼Œè¿”å›æœ€åä¸€ä¸ª\nreturn levelForGrace[levelForGrace.length-1];\n}\nlet graceForLevel=[700,650,600,550];\nlet levelText=['ä¿¡ç”¨æå¥½','ä¿¡ç”¨ä¼˜ç§€','ä¿¡ç”¨è‰¯å¥½','ä¿¡ç”¨ä¸­ç­‰','ä¿¡ç”¨è¾ƒå·®'];\nshowGrace(696,graceForLevel,levelText) // \"ä¿¡ç”¨ä¼˜ç§€\"\nä¼˜ç‚¹ï¼š")]),e._v(" "),n("p",[e._v("æ‘†è„±äº†ç¼–å†™é‡å¤ if-else çš„å›°å¢ƒ\nç›¸æ¯”è¾ƒäº switch æ›´åŠ çµæ´»ï¼Œå¯åŠ¨æ€æ·»åŠ æ˜ å°„å…³ç³»\nç¼ºç‚¹ï¼š")]),e._v(" "),n("p",[e._v("åªé€‚ç”¨äºç®€å•æ¡ä»¶åˆ¤æ–­ï¼Œæ— æ³•è§£å†³åµŒå¥—çš„æƒ…å†µ\nç­–ç•¥æ¨¡å¼\né’ˆå¯¹ä¸€ç»„ç®—æ³•ï¼ˆç­–ç•¥ï¼‰ï¼Œå°†æ¯ä¸ªç®—æ³•ï¼ˆç­–ç•¥ï¼‰åˆ†åˆ«å°è£…åœ¨å…·æœ‰å…±åŒæ¥å£çš„ç‹¬ç«‹ç±»ä¸­ï¼Œæ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ä¸åŒçš„ç­–ç•¥å®Œæˆä»»åŠ¡ã€‚")]),e._v(" "),n("p",[e._v("ä»¥ç»©æ•ˆç­‰çº§å’Œè–ªèµ„è®¡ç®—å¥–é‡‘ä¸ºè¯´æ˜ï¼š")]),e._v(" "),n("p",[e._v("let calculateBouns = (level,salary)=>{\nif(level=='A'){\nreturn salary * 1.4;\n}else if(level=='B'){\nreturn salary * 1.3;\n}else if(level=='C'){\nreturn salary * 1.2;\n}else{\nreturn salary;\n}\n}\nconsole.log(calculateBouns('A', 8000)); //11200\nconsole.log(calculateBouns('C', 8000)); //9600")]),e._v(" "),n("p",[e._v("/*\n*********** é‡æ„å ***********\n*/\n//ç­–ç•¥å¯¹è±¡\nclass ruleA{\ncalculate(salary){\nreturn salary * 1.4;\n}\n}\nclass ruleB{\ncalculate(salary){\nreturn salary * 1.3;\n}\n}\nclass ruleC{\ncalculate(salary){\nreturn salary * 1.2;\n}\n}")]),e._v(" "),n("p",[e._v("//å¥–é‡‘ç±»\nclass Bouns{\nconstructor(){\nthis.salary = null;\nthis.level = null;\n}\nsetLevel(level){\nthis.level = level;\n}\nsetSalary(salary){\nthis.salary = salary;\n}\ngetBouns(){\nreturn this.level.calculate(this.salary);\n}\n}")]),e._v(" "),n("p",[e._v("let tom = new Bouns(),jerry = new Bouns();\n//è®¾ç½®è–ªèµ„\ntom.setSalary(8000);\njerry.setSalary(10000);\n//è®¾ç½®ç­–ç•¥å¯¹è±¡\ntom.setLevel(new ruleA());\njerry.setLevel(new ruleA());\nconsole.log(tom.getBouns()); //11200\nconsole.log(jerry.getBouns()); //14000")]),e._v(" "),n("p",[e._v("jerry.setLevel(new ruleB());\nconsole.log(jerry.getBouns()); //13000\nå½“ç„¶è¿˜æœ‰ä¸€äº›ç»„ä»¶åº“ï¼Œå¦‚ Ant Design çš„è¡¨å•æ ¡éªŒä¹Ÿæ˜¯åº”ç”¨çš„è¿™ç§æ¨¡å¼ï¼Œè¿™é‡Œä¸ç»†è¯´äº†ã€‚")]),e._v(" "),n("p",[e._v("ä¼˜ç‚¹ï¼š")]),e._v(" "),n("p",[e._v("ç­–ç•¥æ¨¡å¼åˆ©ç”¨ç»„åˆã€å§”æ‰˜ç­‰æŠ€æœ¯å’Œæ€æƒ³ï¼Œå¯ä»¥é¿å…å¾ˆå¤šifæ¡ä»¶è¯­å¥\nç­–ç•¥æ¨¡å¼æä¾›äº†å¼€æ”¾-å°é—­åŸåˆ™ï¼Œä½¿ä»£ç æ›´å®¹æ˜“ç†è§£å’Œæ‹“å±•\nç¼ºç‚¹ï¼š")]),e._v(" "),n("p",[e._v("å®¢æˆ·ç«¯å¿…é¡»çŸ¥é“æ‰€æœ‰çš„ç­–ç•¥ç±»ï¼Œå¹¶è‡ªè¡Œå†³å®šä½¿ç”¨å“ªä¸€ä¸ªç­–ç•¥ç±»ã€‚\nç­–ç•¥æ¨¡å¼å°†äº§ç”Ÿå¾ˆå¤šç­–ç•¥ç±»ï¼Œå¯¼è‡´å¯¹è±¡æ•°é‡å¢åŠ ã€‚\nåº”ç”¨åœºæ™¯ï¼š")]),e._v(" "),n("p",[e._v("å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿé‡Œé¢æœ‰è®¸å¤šç±»ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä»…åœ¨äºå®ƒä»¬çš„è¡Œä¸ºï¼Œé‚£ä¹ˆä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°è®©ä¸€ä¸ªå¯¹è±¡åœ¨è®¸å¤šè¡Œä¸ºä¸­é€‰æ‹©ä¸€ç§è¡Œä¸ºã€‚\nä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§ã€‚\nä¸å¸Œæœ›å®¢æˆ·ç«¯çŸ¥é“å¤æ‚çš„ã€ä¸ç®—æ³•ç›¸å…³çš„æ•°æ®ç»“æ„ï¼Œåœ¨å…·ä½“ç­–ç•¥ç±»ä¸­å°è£…ç®—æ³•å’Œç›¸å…³çš„æ•°æ®ç»“æ„ï¼Œæé«˜ç®—æ³•çš„ä¿å¯†æ€§ä¸å®‰å…¨æ€§ã€‚\nçŠ¶æ€æœºæ¨¡å¼\nä¸€ä¸ªçŠ¶æ€å¯¹åº”ä¸€ä¸ªè¡Œä¸ºï¼Œå°è£…åœ¨ä¸€ä¸ªç±»é‡Œï¼ŒçŠ¶æ€ä¸çŠ¶æ€é—´ã€è¡Œä¸ºä¸è¡Œä¸ºé—´å½¼æ­¤ç‹¬ç«‹äº’ä¸å¹²æ‰°ï¼Œé€šè¿‡æ”¹å˜çŠ¶æ€æ¥æ”¹å˜ä¸åŒçš„è¡Œä¸ºã€‚")]),e._v(" "),n("p",[e._v("çº¢ç»¿ç¯ç¤ºä¾‹ï¼š")]),e._v(" "),n("p",[e._v("var trafficLight = (function () {\nvar currentLight = null;\nreturn {\nchange: function (light) {\ncurrentLight = light;\ncurrentLight.go();\n}\n}\n})();")]),e._v(" "),n("p",[e._v('function RedLight() { }\nRedLight.prototype.go = function () {\nconsole.log("this is red light");\n}')]),e._v(" "),n("p",[e._v('function GreenLight() { }\nGreenLight.prototype.go = function () {\nconsole.log("this is green light");\n}')]),e._v(" "),n("p",[e._v('function YellowLight() { }\nYellowLight.prototype.go = function () {\nconsole.log("this is yellow light");\n}')]),e._v(" "),n("p",[e._v("trafficLight.change(new RedLight());\ntrafficLight.change(new YellowLight());\nä¼˜ç‚¹ï¼š")]),e._v(" "),n("p",[e._v("ä¸€ä¸ªçŠ¶æ€å¯¹åº”ä¸€ç§è¡Œä¸ºï¼Œå°è£…åœ¨ä¸€ä¸ªç±»é‡Œï¼Œæ›´ç›´è§‚æ¸…æ™°ï¼Œå¢æ”¹æ–¹ä¾¿")]),e._v(" "),n("ol",[n("li",[e._v("çŠ¶æ€ä¸çŠ¶æ€é—´ï¼Œè¡Œä¸ºä¸è¡Œä¸ºé—´å½¼æ­¤ç‹¬ç«‹äº’ä¸å¹²æ‰°")]),e._v(" "),n("li",[e._v("é¿å…å› äº‹ç‰©å¯¹è±¡æœ¬èº«ä¸æ–­è†¨èƒ€è€Œå¯¼è‡´æ¡ä»¶åˆ¤æ–­è¯­å¥è¿‡å¤š")])]),e._v(" "),n("p",[e._v("ç¼ºç‚¹ï¼š")]),e._v(" "),n("ol",[n("li",[e._v("éœ€è¦å°†äº‹ç‰©çš„ä¸åŒçŠ¶æ€ä»¥åŠå¯¹åº”çš„è¡Œä¸ºæ‹†åˆ†å‡ºæ¥ï¼Œå¦‚æœæ²¡æœ‰æ‹†åˆ†æ ‡å‡†ï¼Œæœ‰æ—¶å€™ä¼šå¯¼è‡´æ‹†åˆ†å¾—å¾ˆç»†ï¼Œé€ æˆè¿‡åº¦è®¾è®¡ï¼Œæ²¡æœ‰æŠ½è±¡æ¦‚å¿µï¼Œç¼ºå°‘å…¬å…±è¡Œä¸ºçš„å¤ç”¨ã€‚")]),e._v(" "),n("li",[e._v("å¿…ç„¶ä¼šå¢åŠ äº‹ç‰©ç±»å’ŒåŠ¨ä½œç±»çš„ä¸ªæ•°ï¼Œæœ‰æ—¶å€™åŠ¨ä½œç±»å†æ ¹æ®å•ä¸€åŸåˆ™ï¼ŒæŒ‰ç…§åŠŸèƒ½æ‹†æˆå‡ ä¸ªç±»ï¼Œä¼šåè€Œä½¿å¾—ä»£ç æ··ä¹±ï¼Œå¯è¯»æ€§é™ä½ã€‚")])]),e._v(" "),n("p",[e._v("åº”ç”¨åœºæ™¯ï¼š")]),e._v(" "),n("ol",[n("li",[e._v("ä¸€ä¸ªç”±ä¸€ä¸ªæˆ–å¤šä¸ªåŠ¨æ€å˜åŒ–çš„å±æ€§å¯¼è‡´å‘ç”Ÿä¸åŒè¡Œä¸ºçš„å¯¹è±¡ï¼Œåœ¨ä¸å¤–éƒ¨äº‹ä»¶äº§ç”Ÿäº’åŠ¨æ—¶ï¼Œå…¶å†…éƒ¨çŠ¶æ€å°±ä¼šæ”¹å˜ï¼Œä»è€Œä½¿å¾—ç³»ç»Ÿçš„è¡Œä¸ºä¹Ÿéšä¹‹å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ï¼Œå°±æ˜¯æœ‰çŠ¶æ€çš„å¯¹è±¡")]),e._v(" "),n("li",[e._v("ä»£ç ä¸­åŒ…å«å¤§é‡ä¸å¯¹è±¡çŠ¶æ€æœ‰å…³çš„æ¡ä»¶è¯­å¥ï¼Œåƒæ˜¯if else æˆ–switch case è¯­å¥ï¼Œä¸”è¿™äº›æ¡ä»¶æ‰§è¡Œä¸å¦ä¾èµ–äºè¯¥å¯¹è±¡çš„çŠ¶æ€ã€‚")])]),e._v(" "),n("p",[e._v("èŒè´£é“¾æ¨¡å¼")]),e._v(" "),n("p",[e._v("å°†èƒ½å¤Ÿå¤„ç†åŒä¸€ç±»è¯·æ±‚çš„å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¯¹é“¾ä¸Šçš„å¯¹è±¡è¿›è¡Œé€ä¸€åˆ¤æ–­æ˜¯å¦æœ‰èƒ½åŠ›å¤„ç†è¯¥è¯·æ±‚ï¼Œå¦‚æœèƒ½åˆ™å°±å¤„ç†ï¼Œå¦‚æœä¸èƒ½ï¼Œåˆ™ä¼ ç»™é“¾ä¸Šçš„ä¸‹ä¸€ä¸ªå¯¹è±¡ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚")]),e._v(" "),n("p",[e._v("const rules = [\n{\nmatch: function (a, b, c) { /* ... "),n("em",[e._v("/ },\naction: function (a, b, c) { /")]),e._v(" ... "),n("em",[e._v("/ }\n},\n{\nmatch: function (a, b, c) { /")]),e._v(" ... "),n("em",[e._v("/ },\naction: function (a, b, c) { /")]),e._v(" ... "),n("em",[e._v("/ }\n},\n{\nmatch: function (a, b, c) { /")]),e._v(" ... "),n("em",[e._v("/ },\naction: function (a, b, c) { /")]),e._v(" ... */ }\n}\n// ...\n]")]),e._v(" "),n("p",[e._v("function demo (a, b, c) {\nfor (let i = 0; i < rules.length; i++) {\nif (rules[i].match(a, b, c)) {\nreturn rules[i].action(a, b, c)\n}\n}\n}\nåº”ç”¨åœºæ™¯ï¼š")]),e._v(" "),n("p",[e._v("æ¯ä¸ª else-if åˆ†æ”¯éƒ½åŒ…å«äº†å¤æ‚çš„æ¡ä»¶åˆ¤æ–­ï¼Œä¸”å…¶å¯¹æ‰§è¡Œçš„å…ˆåé¡ºåºæœ‰æ‰€è¦æ±‚ï¼Œæœ€åä»…è¿›å…¥å…¶ä¸­ä¸€ä¸ª\nè§£å†³æ€è·¯\nå¯¹å½“å‰é—®é¢˜åœºæ™¯è¿›è¡Œåˆ†æ\nå‚æ•°ç»“æ„æ— è§„å¾‹æ€§ï¼ˆæœ‰å•ä¸ªå¯¹è±¡ï¼Œä¹Ÿæœ‰æ•°ç»„å¯¹è±¡é‡Œé¢åˆåµŒå¥—äº†æ•°ç»„å¯¹è±¡ï¼‰\næœ‰ if åµŒå¥—ï¼Œæ ¹æ®æ¡ä»¶å­—æ®µè¿›å…¥ä¸åŒçš„ if è¯­å¥ï¼ˆæ•°å€¼åŒºé—´ã€ç›¸å¯¹æ—¶é—´ã€ç»å¯¹æ—¶é—´ï¼‰\nå¯¹å‚æ•°æ ¡éªŒæœ‰å…ˆåé¡ºåº\néªŒè¯ä¸€æ—¦ä¸é€šè¿‡åˆ™ä¸è¿›è¡Œä¸‹ä¸€æ­¥çš„æ ¡éªŒ\nåˆæ­¥æ–¹æ¡ˆï¼šèŒè´£é“¾æ¨¡å¼ + Promise\nä½¿ç”¨èŒè´£é“¾å¯¹è±¡æŠŠæ»¡è¶³æ¡ä»¶çš„æ ¡éªŒæ–¹æ³•åŠ¨æ€å­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œè°ƒç”¨ execute æ–¹æ³•å¯¹æ•°ç»„è¿›è¡Œéå†æ‰§è¡Œï¼Œä¸€æ—¦æ ¡éªŒä¸é€šè¿‡åˆ™ä¸­æ–­éå†ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ã€‚")]),e._v(" "),n("p",[e._v("// æ ¡éªŒèŒè´£é“¾å¯¹è±¡\nclass ValidateChain {\nconstructor() {\nthis.chain = []\nthis.condition = true\n}\n// ifæ¡ä»¶åˆ†æ”¯\nmatch(condition = true) {\nthis.condition = condition\nreturn this\n}\n// åŠ¨æ€æ·»åŠ æ ¡éªŒæ–¹æ³•\naddValidator(validator) {\nif (!this.condition) return this\nthis.chain.push(validator)\nreturn this\n}\n// æ‰§è¡Œæ‰€æœ‰æ ¡éªŒæ–¹æ³•\nexecute() {\nreturn new Promise((resolve, reject) => {\nfor (let validator of this.chain) {\nconst errMsg = validator()\nif (errMsg) {\nreject(errMsg)\n}\n}\nresolve()\n})\n}\n}")]),e._v(" "),n("p",[e._v("validateChain // æ ¡éªŒè¡Œä¸ºæ»¡è¶³æ—¶é—´\n.match(behaviorTime.time_type === 'opp')\n.addValidator(() => isEmpty(behaviorTime.time_opp_cnt) && 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³æ—¶é—´ï¼')\n.addValidator(() => !validateNoNegativeInt(behaviorTime.time_opp_cnt) && 'è¡Œä¸ºæ»¡è¶³æ—¶é—´åªèƒ½ä¸ºéè´Ÿæ•´æ•°ï¼')")]),e._v(" "),n("p",[e._v("...")]),e._v(" "),n("p",[e._v("for(let bes of behaviorEventSelects) {\nvalidateChain\n.match()\n.addValidator(() => !dataResourceSelects.find(el => el.data_resource_id == bes.data_resource_id) && 'è¯·ç¡®è®¤è¡Œä¸ºæ»¡è¶³ä¸­çš„äº‹ä»¶æ‰€å±æ•°æ®æºéƒ½è¢«é€‰ä¸­ï¼')\n.addValidator(() => isSomeEmpty([bes.event_code, bes.op, bes.times]) && 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³äº‹ä»¶ï¼')\n.addValidator(() => !validateNoNegativeInt(bes.times) && 'è¡Œä¸ºæ»¡è¶³äº‹ä»¶æ¬¡æ•°åªèƒ½ä¸ºéè´Ÿæ•´æ•°ï¼')")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("const fieldSelects = bes.fieldSelects\nif (Array.isArray(fieldSelects)) {\n    for (let el of fieldSelects) {\n        validateChain\n            .match()\n            .addValidator(() => isSomeEmpty([el.field_key, el.op]) && 'è¯·å¡«å†™è¡Œä¸ºæ»¡è¶³å­—æ®µï¼')\n            .match(el.field_type === 'string') // å­—æ®µç±»å‹ä¸ºstringç±»å‹\n            .addValidator(() => isEmpty(el.op_value) && !['-null', '-nnll'].includes(el.op) && 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³å­—æ®µï¼')\n            .match(el.field_type === 'number') // å­—æ®µç±»å‹ä¸ºnumberç±»å‹\n            ...\n    }\n}\n")])])]),n("p",[e._v("}\nvalidateChain\n.execute()\n.then(() => {\n// æ ¡éªŒé€šè¿‡\n})\n.catch(errMsg => {\n// æ ¡éªŒå¤±è´¥\n})\n})\nè¿™ä¸ªæ–¹æ¡ˆè™½ç„¶è®©æ ¡éªŒé¡ºåºæ›´æ¸…æ™°ï¼Œä½†æ˜¯è€¦åˆåº¦è¿˜æ˜¯å¤ªå¼ºï¼Œä¸åˆ©äºæ‰©å±•ã€‚")]),e._v(" "),n("p",[e._v("è§£å†³æ–¹æ¡ˆï¼šç­–ç•¥æ¨¡å¼ + èŒè´£é“¾æ¨¡å¼ + Promise\nä¸ºä»€ä¹ˆä¸ç”¨çŠ¶æ€æœºæ¨¡å¼è€Œç”¨ç­–ç•¥æ¨¡å¼ï¼Ÿ")]),e._v(" "),n("p",[e._v("çŠ¶æ€æœºæ¨¡å¼æ—¨åœ¨æ ¹æ®ä¸åŒçš„çŠ¶æ€è§¦å‘ä¸ç”¨çš„è¡Œä¸ºï¼Œè€Œç­–ç•¥æ¨¡å¼æ˜¯ç”±å®¢æˆ·ç«¯è‡ªå·±å†³å®šè°ƒç”¨å“ªäº›ç­–ç•¥ï¼Œä»åŠŸèƒ½ä¸Šè¯´ç­–ç•¥æ¨¡å¼åœ¨ç›®å‰åœºæ™¯ä¸‹æ›´é€‚ç”¨ã€‚")]),e._v(" "),n("p",[e._v("ç­–ç•¥æ¨¡å¼æ‰®æ¼”è§’è‰²ï¼š\nå°†è¡¨å•åŒºåŸŸåˆ†ä¸ºå¤šä¸ªç­–ç•¥å¯¹è±¡ï¼Œæ¯ä¸ªç­–ç•¥å¯¹è±¡ç»§æ‰¿å…±åŒçš„ç¥–å…ˆå¯¹è±¡ï¼Œç¥–å…ˆå¯¹è±¡æœ‰å…¬å…±çš„æ ¡éªŒæ–¹æ³•ï¼Œæ¯ä¸ªç­–ç•¥å¯¹è±¡å°†åŸå…ˆçš„ if æ¡ä»¶åˆ¤æ–­åˆ’åˆ†ä¸ºå¤šä¸ªæ ¡éªŒæ–¹æ³•ï¼Œç”¨ init æ–¹æ³•è°ƒç”¨èŒè´£é“¾å¯¹è±¡ï¼ŒæŒ‰é¡ºåºæ·»åŠ ç­–ç•¥æ–¹æ³•ã€‚\nèŒè´£é“¾æ¨¡å¼æ‰®æ¼”è§’è‰²ï¼š\né‡‡ç”¨å¢é‡å¼é“¾å¼è°ƒç”¨ï¼ŒåŠ¨æ€æ·»åŠ æ¥è‡ªç­–ç•¥å¯¹è±¡çš„ç­–ç•¥æ–¹æ³•ã€‚")]),e._v(" "),n("p",[e._v("// å…¬å…±ç­–ç•¥å¯¹è±¡\nclass BaseRule {\n// æ ¡éªŒç©º\nvalidateEmpty = (val, msg) => () => {\nreturn isEmpty(val) && msg\n}\n// æ ¡éªŒä¸€å®šæ•°é‡å­—æ®µæ˜¯å¦ä¸ºç©º\nvalidateSomeEmpty = (val, msg) => () => {\nreturn isSomeEmpty(val) && msg\n}\n// æ ¡éªŒéè´Ÿæ•°\nvalidateNoNegative = (val, msg) => () => {\nreturn !isNoNegative(val) && msg\n}\n// æ ¡éªŒæ•°å€¼èŒƒå›´æ˜¯å¦è¶…å‡º\nvalidateNumRange = (min, max, range, msg) => () => {\nreturn (parseFloat(min) <= range[0] || parseFloat(max) > range[1]) && msg\n}\n// æ ¡éªŒæœ€å°å€¼æ˜¯å¦å°äºæœ€å¤§å€¼\nvalidateSize = (min, max, msg) => () => {\nreturn +min >= +max && msg\n}\n// æ ¡éªŒç»å¯¹æ—¶é—´å¤§å°\nvalidateStartTimeAndEndTime = (start, end, msg) => () => {\nreturn !moment(+start).isBefore(moment(+end)) && msg\n}\n}\n// è¡Œä¸ºæ»¡è¶³ç­–ç•¥å¯¹è±¡\nclass BehaviorEventRule extends BaseRule {\nconstructor({\nselects, dataResourceSelects, time\n}, chain) {\nsuper()\nthis.selects = selects\nthis.dataResourceSelects = dataResourceSelects\nthis.time = time\nthis.chain = chain\nthis.hasTimeMsg = 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³æ—¶é—´ï¼'\nthis.isStartTimeAndEndTimeMsg = 'è¡Œä¸ºæ»¡è¶³å¼€å§‹æ—¶é—´è¦å°äºç»“æŸæ—¶é—´ï¼'\nthis.isOppTimeNoNegativeMsg = 'è¡Œä¸ºæ»¡è¶³æ—¶é—´åªèƒ½ä¸ºéè´Ÿæ•´æ•°ï¼'\nthis.hasDataResourceSelectedMsg = 'è¯·ç¡®è®¤è¡Œä¸ºæ»¡è¶³ä¸­çš„äº‹ä»¶æ‰€å±æ•°æ®æºéƒ½è¢«é€‰ä¸­ï¼'\nthis.isEventFilledMsg = 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³äº‹ä»¶ï¼'\nthis.isEventTimeNoNegativeMsg = 'è¡Œä¸ºæ»¡è¶³äº‹ä»¶æ¬¡æ•°åªèƒ½ä¸ºéè´Ÿæ•´æ•°ï¼'\nthis.isFieldFilledMsg = 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³å­—æ®µï¼'\nthis.isOverNumRangeMsg = 'è¡Œä¸ºæ»¡è¶³å­—æ®µè¶…å‡ºæ•°å€¼èŒƒå›´ï¼'\nthis.isValidBetweenTimeMsg = 'è¡Œä¸ºæ»¡è¶³å­—æ®µç»å¯¹æ—¶é—´éæ³•ï¼'\nthis.isMinLessThanMaxMsg = 'è¡Œä¸ºæ»¡è¶³å­—æ®µæœ€å°å€¼åº”å°äºæœ€å¤§å€¼ï¼'\nthis.isFieldStartTimeAndEndTimeMsg = 'è¡Œä¸ºæ»¡è¶³å­—æ®µä¸­å¼€å§‹æ—¶é—´è¦å°äºç»“æŸæ—¶é—´ï¼'\n}")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("// æ ¡éªŒäº‹ä»¶æ‰€å±äº‹ä»¶æºéƒ½è¢«é€‰ä¸­\nhasDataResourceSelects = event => () => {\n        return !this.dataResourceSelects.find(el => el.data_resource_id == event.data_resource_id) && this.hasDataResourceSelectedMsg\n    }\n    // æ ¡éªŒstringç±»å‹å­—æ®µæ˜¯å¦å¡«å†™\nhasStringFieldFilled = field => () => {\n        return isEmpty(field.op_value) && !['-null', '-nnll'].includes(field.op) && this.isFieldFilledMsg\n    }\n    // æ ¡éªŒç»å¯¹æ—¶é—´å­—æ®µæ ¼å¼YYYY-MM-DD\nisValidBetweenTime = (startTime, endTime) => () => {\n        return !(invalidDateTime('YYYY-MM-DD', startTime) && invalidDateTime('YYYY-MM-DD', endTime)) && this.isValidBetweenTimeMsg\n    }\n    // è§„åˆ™åˆå§‹åŒ–\ninit() {\n    // æ ¡éªŒç›¸å¯¹æ—¶é—´å’Œç»å¯¹æ—¶é—´\n    this.chain\n        .match(this.time.time_type === 'opp')\n        .addValidator(this.validateEmpty(this.time.time_opp_cnt, this.hasTimeMsg))\n        .addValidator(this.validateNoNegative(this.time.time_opp_cnt, this.isOppTimeNoNegativeMsg))\n        .match(this.time.time_type === 'between')\n        .addValidator(this.validateStartTimeAndEndTime(this.time.time_between_from, this.time.time_between_to, this.isStartTimeAndEndTimeMsg))\n\n    for (let event of this.selects) {\n        // æ ¡éªŒäº‹ä»¶\n        this.chain\n            .match()\n            .addValidator(this.hasDataResourceSelects(event))\n            .addValidator(this.validateSomeEmpty([event.event_code, event.op, event.times], this.isEventFilledMsg))\n            .addValidator(this.validateNoNegative(event.times, this.isEventTimeNoNegativeMsg))\n\n        const fieldSelects = event.fieldSelects\n        if (Array.isArray(fieldSelects)) {\n            for (let field of fieldSelects) {\n                this.chain\n                    .match()\n                    .addValidator(this.validateSomeEmpty([field.field_key, field.op], this.isFieldFilledMsg))\n                    .match(field.field_type === 'string')\n                    .addValidator(this.hasStringFieldFilled(field))\n                    ...\n            }\n        }\n    }\n}\n")])])]),n("p",[e._v("}")]),e._v(" "),n("p",[e._v("// å®¢æˆ·ç«¯è°ƒç”¨\nconst validatorChain = new ValidateChain()\nconst behaviorEventRule = new BehaviorEventRule({\nselects: behaviorEventSelects,\ndataResourceSelects,\ntime: behaviorTime\n}, validatorChain)\nbehaviorEventRule.init()")]),e._v(" "),n("p",[e._v("validatorChain\n.execute()\n.then(() => {\n// æ ¡éªŒæˆåŠŸ\t\t\t\t\t\n})\n.catch(() => {\n// æ ¡éªŒå¤±è´¥\t\t\t\t\n})\nBaseRule ä¸ºå…¬å…±ç­–ç•¥å¯¹è±¡ï¼Œå«å…¬å…±æ ¡éªŒæ–¹æ³•ï¼ŒBehaviorEventRuleä¸ºæŸä¸ªç­–ç•¥å¯¹è±¡ï¼Œå«è‡ªèº«æ ¡éªŒæ–¹æ³•ã€‚")]),e._v(" "),n("p",[e._v("æ¯ä¸ªç­–ç•¥å¯¹è±¡ç›¸å¯¹ç‹¬ç«‹ï¼Œäº’ä¸å½±å“ï¼Œæ–¹ä¾¿åé¢è¿­ä»£ç»´æŠ¤ã€æ‰©å±•ï¼Œéœ€æ±‚æ¥äº†ä¸å†å¤´ç—›ï¼è¿™å°±æ˜¯é‡æ„çš„æ„ä¹‰ï¼")]),e._v(" "),n("p",[e._v("å›é¡¾ä¸‹é‡æ„å‰çš„å™©æ¢¦\néœ€è¦æ ¡éªŒå‚æ•°ç»“æ„ï¼š")]),e._v(" "),n("p",[e._v('{\n...\n"data_resources": [\n{\n"data_resource_id": 259,\n"data_biz_type": "user_event",\n"data_resource_name": "éŸ³å…”iOS"\n},\n{\n"data_resource_id": 213,\n"data_biz_type": "user_attribute",\n"data_resource_name": "é›†ç¾¤å¯¼å…¥ç”¨æˆ·å±æ€§ç±»å‹"\n}\n],\n...\n"behavior_filter": {\n"time_type": "opp",\n"time_opp_cnt": 3,\n"time_opp_unit": "month",\n"ops": [],\n"behaviors": [\n{\n"event_code": "status_login_success",\n"event_name": "ç™»å½•æˆåŠŸ",\n"op": "-gt",\n"times": 3,\n"event_filter": [\n{\n"field_key": "event_time",\n"field_type": "datetime",\n"storage_field_type": "STRING",\n"field_name": "æ—¶é—´",\n"op": "between",\n"op_value": "2018-12-20,2019-02-01",\n"time_type": "between",\n"time_opp_unit": "day",\n"time_format": "yyyy-MM-dd HHğŸ‡²ğŸ‡²ss"\n},\n{\n"field_key": "package_size",\n"field_type": "number",\n"storage_field_type": "STRING",\n"field_name": "åŒ…å¤§å°",\n"op": "-btn",\n"op_value": "10,50"\n},\n{\n"field_key": "province",\n"field_type": "string",\n"storage_field_type": "STRING",\n"field_name": "çœä»½",\n"op": "-is",\n"op_value": "å¹¿ä¸œ"\n}\n],\n"data_resource_id": 259\n}\n]\n},\n...\n"user_attribute_filter": {\n"ops": [\n"and"\n],\n"atts": [\n{\n"field_key": "first_date",\n"field_type": null,\n"storage_field_type": "STRING",\n"field_name": "first_date",\n"op": null,\n"op_value": "2",\n"time_type": "opp",\n"time_between_from": null,\n"time_between_to": null,\n"time_opp_cnt": 2,\n"time_opp_unit": "day",\n"time_format": "yyyyMMddHHmmss",\n"data_resource_id": 213\n},\n],\n"dmp_crowd_filter": []\n},\n"crowd_id": 1487\n}\né‡æ„å‰çš„éƒ¨åˆ†ä»£ç ï¼š')]),e._v(" "),n("p",[e._v("if (dataResourceSelects.length > uniqEventSelects.length) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'å­˜åœ¨æœªé€‰æ‹©äº‹ä»¶æˆ–å­—æ®µçš„äº‹ä»¶æºï¼',\n})\nreturn\n}\n// æ ¡éªŒdataResourceSelects\nfor (let s of dataResourceSelects) {\nif (!s.data_resource_id) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¯·å¡«å†™å®Œæ•°æ®æºï¼',\n})\nreturn\n}\n}")]),e._v(" "),n("p",[e._v("// æ ¡éªŒbehavior_filter\nif (behaviorTime.time_type === 'opp') {\nif (behaviorTime.time_opp_cnt === '') {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³æ—¶é—´ï¼',\n})\nreturn\n} else if (!validateNoNegativeInt(behaviorTime.time_opp_cnt)) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¡Œä¸ºæ»¡è¶³æ—¶é—´åªèƒ½ä¸ºéè´Ÿæ•´æ•°ï¼',\n})\nreturn\n}\n}\nif (behaviorEventSelects.length === 0) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¡Œä¸ºæ»¡è¶³å¿…å¡«ï¼',\n})\nreturn\n}\nfor (let bes of behaviorEventSelects) {\nif (!dataResourceSelects.find(el => el.data_resource_id == bes.data_resource_id)) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¯·ç¡®è®¤è¡Œä¸ºæ»¡è¶³ä¸­çš„äº‹ä»¶æ‰€å±æ•°æ®æºéƒ½è¢«é€‰ä¸­ï¼',\n})\nreturn\n}\nif (!bes.event_code || !bes.op || bes.times === '') {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³äº‹ä»¶ï¼',\n})\nreturn\n}\nif (!validateNoNegativeInt(bes.times)) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¡Œä¸ºæ»¡è¶³äº‹ä»¶æ¬¡æ•°åªèƒ½ä¸ºéè´Ÿæ•´æ•°ï¼',\n})\nreturn\n}\nconst fieldSelects = bes.fieldSelects\nif (Array.isArray(fieldSelects)) {\nfor (let el of fieldSelects) {\nif (!el.field_key || !el.op) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³å­—æ®µï¼',\n})\nreturn\n}\nif (el.field_type === 'string' && !['-null', '-nnll'].includes(el.op) && el.op_value === '') {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³å­—æ®µï¼',\n})\nreturn\n} else if (el.field_type === 'number' && el.op == '-btn' &&\n(el.op_value.split(',')[0] === '' || el.op_value.split(',')[1] === '')) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³å­—æ®µï¼',\n})\nreturn\n} else if (el.field_type === 'number' && el.op !== '-btn' && el.op_value == '') {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¯·å¡«å†™å®Œè¡Œä¸ºæ»¡è¶³å­—æ®µï¼',\n})\nreturn\n} else if (el.field_type === 'number' && el.op !== '-btn' && !validateRealNum(el.op_value)) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¡Œä¸ºæ»¡è¶³å­—æ®µæ•°å€¼åªèƒ½ä¸ºå®æ•°ï¼',\n})\nreturn\n} else if (el.field_type === 'number' && el.op == '-btn' &&\n(!validateRealNum(el.op_value.split(',')[0]) || !validateRealNum(el.op_value.split(',')[1]))) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¡Œä¸ºæ»¡è¶³å­—æ®µæ•°å€¼åªèƒ½ä¸ºå®æ•°ï¼',\n})\nreturn\n} else if (el.field_type === 'number' && el.op == '-btn' &&\n(parseInt(el.op_value.split(',')[0]) > parseInt(el.op_value.split(',')[1]))) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¡Œä¸ºæ»¡è¶³å­—æ®µæœ€å°å€¼åº”å°äºç­‰äºæœ€å¤§å€¼ï¼',\n})\nreturn\n} else if (el.field_type === 'number' && el.op == '-btn' &&\n(parseInt(el.op_value.split(',')[0]) <= 0 || parseInt(el.op_value.split(',')[1]) > 100)) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¡Œä¸ºæ»¡è¶³å­—æ®µè¶…å‡ºæ•°å€¼èŒƒå›´ï¼',\n})\nreturn\n} else if (el.field_type === 'datetime' && el.time_type === 'between' && !(\nvalidateDateTime('YYYY-MM-DD', el.time_between_from) &&\nvalidateDateTime('YYYY-MM-DD', el.time_between_to))) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¡Œä¸ºæ»¡è¶³å­—æ®µç»å¯¹æ—¶é—´éæ³•ï¼',\n})\nreturn\n} else if (el.field_type === 'datetime' && el.time_type === 'between' && !moment(el.time_between_from).isBefore(el.time_between_to)) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¡Œä¸ºæ»¡è¶³å­—æ®µä¸­å¼€å§‹æ—¶é—´è¦å°äºç»“æŸæ—¶é—´',\n})\nreturn\n} else if (el.field_type === 'datetime' && el.time_type === 'opp' && !el.time_opp_cnt) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¡Œä¸ºæ»¡è¶³å­—æ®µç›¸å¯¹æ—¶é—´ä¸èƒ½ä¸ºç©ºï¼',\n})\nreturn\n} else if (el.field_type === 'datetime' && el.time_type === 'opp' && !validateNoNegativeInt(el.time_opp_cnt)) {\nthis.setState({\nerrorModalVisible: true,\nerrorTitle: actionType == MODE.MODIFY ? 'ä¿å­˜å¤±è´¥' : 'åˆ›å»ºå¤±è´¥',\nerrorMsg: 'è¡Œä¸ºæ»¡è¶³å­—æ®µç›¸å¯¹æ—¶é—´åªèƒ½ä¸ºéè´Ÿæ•´æ•°ï¼',\n})\nreturn\n}\n}\n}\n}")])])}),[],!1,null,null,null);n.default=r.exports}}]);