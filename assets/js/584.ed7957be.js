(window.webpackJsonp=window.webpackJsonp||[]).push([[584],{857:function(t,s,n){"use strict";n.r(s);var a=n(14),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("记录一个问题，"),s("code",[t._v("ts")]),t._v("文件中对"),s("code",[t._v("import")]),t._v("语句的条件编译不生效。"),s("code",[t._v("debug")]),t._v(" 的时候会发现 "),s("code",[t._v("ts")]),t._v(" 文件内部 "),s("code",[t._v("import")]),t._v(" 的部分已经换成了 "),s("code",[t._v("require")]),t._v("，以及引入了一些 "),s("code",[t._v("polyfill")]),t._v("。")]),t._v(" "),s("p",[t._v("问题原因在于使用 chainWebpack 时候使用了一个错误的 rule 名称")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("module\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rule")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.[jt]s$")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("LOADER_MAP")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("crossPlatformProd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("LOADER_MAP")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("crossPlatformProd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("上面的代码对 "),s("code",[t._v("js/ts")]),t._v(" 文件，使用了一个替换关键词的 "),s("code",[t._v("loader")]),t._v("，本来是没问题的，但是 "),s("code",[t._v(".rule('js')")]),t._v(" 这个名字不对，"),s("code",[t._v("vue-cli")]),t._v(" 内部应该已经注册有了，会和以前的合并，导致对 "),s("code",[t._v("ts")]),t._v(" 文件执行所有的 js` 配置，比如一些转化编译。")]),t._v(" "),s("p",[t._v("如何解决？改成一个无关的名字就可以，比如 "),s("code",[t._v("cross-platform-prod")]),t._v("。")])])}),[],!1,null,null,null);s.default=e.exports}}]);