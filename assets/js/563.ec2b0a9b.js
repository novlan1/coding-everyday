(window.webpackJsonp=window.webpackJsonp||[]).push([[563],{833:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("[toc]")]),t._v(" "),s("h2",{attrs:{id:"_1-开始"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-开始"}},[t._v("#")]),t._v(" 1. 开始")]),t._v(" "),s("p",[t._v("介绍一款基于 "),s("code",[t._v("uni-app")]),t._v(" 的跨端组件库——"),s("a",{attrs:{href:"https://novlan1.github.io/press-ui/",target:"_blank",rel:"noopener noreferrer"}},[t._v("press-ui"),s("OutboundLink")],1),t._v("，也可用于普通H5项目。API 与 "),s("code",[t._v("vant")]),t._v(" 一致，可以看作是 "),s("code",[t._v("uni-app")]),t._v(" 版本的 vant。")]),t._v(" "),s("p",[t._v("为什么不用"),s("code",[t._v("uni-ui")]),t._v("或者"),s("code",[t._v("uview")]),t._v("等组件库呢？有两个原因：")]),t._v(" "),s("ol",[s("li",[t._v("我们项目是从H5项目转成"),s("code",[t._v("uni-app")]),t._v("项目的，项目比较大，改动成本高。")]),t._v(" "),s("li",[s("code",[t._v("uni-ui")]),t._v("、"),s("code",[t._v("uview")]),t._v("这些库的API易用性较差，与"),s("code",[t._v("vant")]),t._v("相比差距大。")])]),t._v(" "),s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/press%2Fimg%2Fpress-ui-demo-screenshot.png",width:"300"}}),t._v(" "),s("h2",{attrs:{id:"_2-介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-介绍"}},[t._v("#")]),t._v(" 2. 介绍")]),t._v(" "),s("h3",{attrs:{id:"_2-1-基础介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-基础介绍"}},[t._v("#")]),t._v(" 2.1. 基础介绍")]),t._v(" "),s("ol",[s("li",[t._v("70+ 基础组件，覆盖移动端主流场景")]),t._v(" "),s("li",[t._v("支持基于"),s("code",[t._v("uni-app")]),t._v("的H5、微信小程序、QQ小程序")]),t._v(" "),s("li",[t._v("支持普通H5项目")]),t._v(" "),s("li",[t._v("零外部依赖，不依赖三方 npm 包")]),t._v(" "),s("li",[t._v("提供丰富的中英文文档和组件示例")]),t._v(" "),s("li",[t._v("支持主题定制，内置 600+ 个主题变量")]),t._v(" "),s("li",[t._v("支持国际化，内置 16+ 种语言包")])]),t._v(" "),s("p",[t._v("文档地址："),s("a",{attrs:{href:"https://novlan1.github.io/press-ui/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://novlan1.github.io/press-ui/"),s("OutboundLink")],1)]),t._v(" "),s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/press%2Fimg%2Fpress-ui-doc-screenshot.png",width:"800"}}),t._v(" "),s("p",[t._v("三端示例体验地址：")]),t._v(" "),s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/press/qrcode/press-ui-demo-qrcode-3.png",width:"700"}}),t._v(" "),s("h3",{attrs:{id:"_2-2-解决痛点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-解决痛点"}},[t._v("#")]),t._v(" 2.2. 解决痛点")]),t._v(" "),s("p",[s("code",[t._v("press-ui")]),t._v("主要解决了以下痛点：")]),t._v(" "),s("ol",[s("li",[t._v("可支持包含"),s("code",[t._v("vant")]),t._v("的H5项目平滑迁移至"),s("code",[t._v("uni-app")]),t._v("项目，只需要改下引用地址和组件名称。")]),t._v(" "),s("li",[t._v("丰富的组件类型，以及易用的API，让"),s("code",[t._v("uni-app")]),t._v("开发变得简单。")]),t._v(" "),s("li",[t._v("支持国际化、主题定制等，组件灵活性更强")])]),t._v(" "),s("p",[t._v("同时，将项目中业务组件沉淀到"),s("code",[t._v("press-ui")]),t._v("中，有以下好处：")]),t._v(" "),s("ul",[s("li",[t._v("增强可维护性，提升开发效率\n"),s("ul",[s("li",[t._v("通过整理代码，合并属性，分离业务逻辑等，让组件变纯粹，增强可维护性，进而提升效率")])])]),t._v(" "),s("li",[t._v("减少业务和组件的耦合，降低各自复杂度，并减少bug")]),t._v(" "),s("li",[t._v("封装核心逻辑，控制变化\n"),s("ul",[s("li",[t._v("不用担心外部合作人员改乱代码，以及解决冲突时的覆盖问题")])])]),t._v(" "),s("li",[t._v("UI问题定位简单\n"),s("ul",[s("li",[t._v("三端代码同时发布，以及多种类型的示例，覆盖面全，容易发现ui问题，以及三端表现不一致问题")])])]),t._v(" "),s("li",[t._v("可提升性能\n"),s("ul",[s("li",[t._v("通过自定义队伍数等变量，定位性能瓶颈，并解决性能问题")])])]),t._v(" "),s("li",[t._v("提高可复用性，可应用到其他项目")]),t._v(" "),s("li",[t._v("技术沉淀，技术积累，不断打磨组件细节")])]),t._v(" "),s("h3",{attrs:{id:"_2-3-应用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-应用场景"}},[t._v("#")]),t._v(" 2.3. 应用场景")]),t._v(" "),s("p",[s("code",[t._v("press-ui")]),t._v("可应用于"),s("code",[t._v("uni-app")]),t._v("项目，或者普通的H5项目，目前已应用在王者赛宝、HoK Club、赛宝pro等项目中。")]),t._v(" "),s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2023/4/pvp-esports-screenshort.png",width:"300"}}),t._v(" "),s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2023/4/hok-club-screenshot.png",width:"300"}}),t._v(" "),s("h2",{attrs:{id:"_3-如何使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-如何使用"}},[t._v("#")]),t._v(" 3. 如何使用")]),t._v(" "),s("h3",{attrs:{id:"_3-1-用于uni-app项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-用于uni-app项目"}},[t._v("#")]),t._v(" 3.1. 用于uni-app项目")]),t._v(" "),s("ol",[s("li",[t._v("安装npm包")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i press-ui\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("在页面中正常引入并使用")])]),t._v(" "),s("p",[t._v("比如 "),s("code",[t._v("message-detail")]),t._v(" 组件：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("PressMessageDetail")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" PressMessageDetail "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'press-ui/press-message-detail/press-message-detail.vue'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  components"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    PressMessageDetail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("配置"),s("code",[t._v("vue.config.js")])])]),t._v(" "),s("p",[t._v("注意，需要在"),s("code",[t._v("vue.config.js")]),t._v("中配置下 "),s("code",[t._v("transpileDependencies")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("transpileDependencies")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'press-ui'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-2-用于普通h5项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-用于普通h5项目"}},[t._v("#")]),t._v(" 3.2. 用于普通H5项目")]),t._v(" "),s("p",[s("code",[t._v("press-ui")]),t._v(" 比普通的组件只是多了条件编译，所以加一个支持条件编译的"),s("code",[t._v("loader")]),t._v("就可以解决了，"),s("code",[t._v("loader")]),t._v("代码地址在"),s("a",{attrs:{href:"https://github.com/novlan1/uni-plugin-light/tree/master/loader/ifdef-loader",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[s("code",[t._v("loader")]),t._v("使用方法如下：")]),t._v(" "),s("ol",[s("li",[t._v("安装 npm 包：")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i uni-plugin-light "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-D")]),t._v("\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("在 "),s("code",[t._v("vue.config.js")]),t._v(" 中添加如下设置：")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("LOADER_IFDEF")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'uni-plugin-light/lib/loader/ifdef-loader'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("export "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("chainWebpack")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("module\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rule")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ifdef-loader'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 根据项目实际配置文件类型")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("press-ui.*(\\.vue|\\.ts|\\.js|\\.css|\\.scss)$")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("LOADER_IFDEF")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("LOADER_IFDEF")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("context")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("H5")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'css'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"_4-共建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-共建"}},[t._v("#")]),t._v(" 4. 共建")]),t._v(" "),s("p",[s("code",[t._v("press-ui")]),t._v(" 项目地址在"),s("a",{attrs:{href:"https://github.com/novlan1/press-ui",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),s("OutboundLink")],1),t._v("，文档在"),s("a",{attrs:{href:"https://novlan1.github.io/press-ui/",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"_4-1-后续规划"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-后续规划"}},[t._v("#")]),t._v(" 4.1. 后续规划")]),t._v(" "),s("p",[s("code",[t._v("press-ui")]),t._v("后续规划包括：")]),t._v(" "),s("ul",[s("li",[t._v("支持"),s("code",[t._v("Android")]),t._v("、"),s("code",[t._v("iOS")])]),t._v(" "),s("li",[t._v("优化构建流程和开发体验")]),t._v(" "),s("li",[t._v("减小"),s("code",[t._v("npm")]),t._v("包大小")]),t._v(" "),s("li",[t._v("对外开源")])]),t._v(" "),s("h3",{attrs:{id:"_4-2-共建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-共建"}},[t._v("#")]),t._v(" 4.2. 共建")]),t._v(" "),s("p",[t._v("欢迎体验、试用、共建，可以加入群聊，二维码过期可以私聊加入。")]),t._v(" "),s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/press/img/chat-group/caht-group-20230425.png",width:"300"}}),t._v(" "),s("h2",{attrs:{id:"_5-技术细节"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-技术细节"}},[t._v("#")]),t._v(" 5. 技术细节")]),t._v(" "),s("h3",{attrs:{id:"_5-1-项目结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-项目结构"}},[t._v("#")]),t._v(" 5.1. 项目结构")]),t._v(" "),s("p",[s("code",[t._v("press-ui")]),t._v(" 的项目结构如下：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("- docs            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 文档地址")]),t._v("\n- plugin          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [demo]工程用到的插件")]),t._v("\n- script          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 脚本")]),t._v("\n- src\n  - common        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [demo]公共内容")]),t._v("\n  - packages      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对外发布的包内容")]),t._v("\n  - pages         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [demo]页面内容")]),t._v("\n  - static        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [demo]静态内容")]),t._v("\n  - App.vue       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [demo]应用入口")]),t._v("\n  - main.js\n  - pages.json\n")])])]),s("p",[t._v("组件库除了组件外，还有文档、示例、工程化配置等部分。为了维护起来方便，我将示例、文档、组件都放在一个文件夹里，所以一个标准的组件文件夹目录如下：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("- press-button\n  - demo.vue            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 组件示例")]),t._v("\n  - press-button.vue    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 组件")]),t._v("\n  - README.md           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 组件中文文档")]),t._v("\n  - README.en-US.md     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 组件英文文档")]),t._v("\n")])])]),s("p",[s("code",[t._v("src/packages")]),t._v("下就是由这些组件文件夹和一些公共文件构成。")]),t._v(" "),s("p",[t._v("上面的组织结构并不能直接用，还需要把"),s("code",[t._v("README.md")]),t._v("移动到"),s("code",[t._v("docs")]),t._v("中，把"),s("code",[t._v("demo.vue")]),t._v("移动到"),s("code",[t._v("src/pages")]),t._v("中。这里我写了脚本用来监听这些文件变动，发生变动后就把它们拷贝到需要的位置上，命令为"),s("code",[t._v("npm run dispatch")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"_5-2-监听文件变化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-监听文件变化"}},[t._v("#")]),t._v(" 5.2. 监听文件变化")]),t._v(" "),s("p",[t._v("监听用的是"),s("code",[t._v("gulp")]),t._v("，这里有个比较重要的属性"),s("code",[t._v("delay")]),t._v("，允许在执行任务之前等待许多更改，比如删除文件夹这种操作。"),s("code",[t._v("delay")]),t._v("只支持这种方式：")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("watchPackages")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  gulp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/packages/**/*'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" delay"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("不支持这样使用：")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" watch "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gulp'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" watcher "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'input/*.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nwatcher"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'change'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stats"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("File ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" was changed")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nwatcher"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'add'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stats"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("File ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" was added")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nwatcher"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'unlink'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stats"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("File ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" was removed")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nwatcher"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("参考：https://www.gulpjs.com.cn/docs/api/watch/")]),t._v(" "),s("h3",{attrs:{id:"_5-3-组件来源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-组件来源"}},[t._v("#")]),t._v(" 5.3. 组件来源")]),t._v(" "),s("p",[s("code",[t._v("press-ui")]),t._v("的组件并不都是从零开始写的，而是来源于"),s("code",[t._v("vant")]),t._v("和项目自身沉淀的组件。")]),t._v(" "),s("p",[t._v("对于"),s("code",[t._v("vant")]),t._v("组件转化，实现方式如下：")]),t._v(" "),s("ol",[s("li",[t._v("转化小程序版本的"),s("code",[t._v("vant")]),t._v("，即"),s("code",[t._v("vant-weapp")])]),t._v(" "),s("li",[t._v("将"),s("code",[t._v("wxml/wxss/js/json")]),t._v("转为"),s("code",[t._v("vue")]),t._v("文件，即"),s("code",[t._v("uni-app")]),t._v("编译的逆操作")]),t._v(" "),s("li",[t._v("API 替换为"),s("code",[t._v("uni-app")]),t._v("的通用类型")]),t._v(" "),s("li",[t._v("条件编译处理 API 差异部分")])]),t._v(" "),s("p",[t._v("这样做的好处是，可以大大提升组件编写效率，且 API 保持与"),s("code",[t._v("vant")]),t._v("一致，从而方便用户由"),s("code",[t._v("h5")]),t._v("项目平滑迁移到"),s("code",[t._v("uni-app")]),t._v("项目。")]),t._v(" "),s("p",[t._v("对于项目中沉淀的组件，需与业务完全解耦后沉淀，并且需要具有一定的通用性或复杂度。为什么呢，这样可以让"),s("code",[t._v("press-ui")]),t._v("更稳定，减少变化，发挥"),s("code",[t._v("press-ui")]),t._v("的作用。")]),t._v(" "),s("h3",{attrs:{id:"_5-4-组件质量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-组件质量"}},[t._v("#")]),t._v(" 5.4. 组件质量")]),t._v(" "),s("p",[t._v("如何评价一个组件呢，可以从下面几个维度：")]),t._v(" "),s("ul",[s("li",[t._v("通用性，好的组件一定是通用的，即满足多种场景需求，表现上看就是有很多"),s("code",[t._v("props")]),t._v("、"),s("code",[t._v("slot")]),t._v("，开发者想怎样用就怎样用")]),t._v(" "),s("li",[t._v("兼容性，可在低端机、横竖屏、大小屏等不同场景，都有良好的展示、交互效果")]),t._v(" "),s("li",[t._v("性能，可满足数据量大等场景")])]),t._v(" "),s("p",[t._v("对于业务组件，通用性强的前提是，与业务充分解耦，如何做到呢？")]),t._v(" "),s("ul",[s("li",[t._v("不能存在业务状态码，多重判断逻辑应该前置完成")]),t._v(" "),s("li",[t._v("关注点分离，关注组件自身，而非业务")]),t._v(" "),s("li",[t._v("一个衡量标准是业务更新迭代，业务组件却一直稳定")]),t._v(" "),s("li",[t._v("能用函数调用的，就用函数调用，为什么呢？因为"),s("code",[t._v("js")]),t._v("比"),s("code",[t._v("html")]),t._v("更灵活，灵活意味着通用型更强")])]),t._v(" "),s("h3",{attrs:{id:"_5-5-bem"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-bem"}},[t._v("#")]),t._v(" 5.5. BEM")]),t._v(" "),s("p",[t._v("关于"),s("a",{attrs:{href:"https://getbem.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("BEM"),s("OutboundLink")],1),t._v("可以参考这篇"),s("a",{attrs:{href:"https://juejin.cn/post/7102980936232337445/",target:"_blank",rel:"noopener noreferrer"}},[t._v("文章"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[t._v("笔者对项目中之前的组件，全部进行了BEM改造，以"),s("code",[t._v("press-dialog")]),t._v("为例，改造前：")]),t._v(" "),s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2022/12/press_dialog_before_bem.pic.jpg"}}),t._v(" "),s("p",[t._v("改造后：")]),t._v(" "),s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2022/12/press_dialog_after_bem.pic.jpg"}}),t._v(" "),s("p",[t._v("可以看出，可读性大幅增强。")]),t._v(" "),s("h3",{attrs:{id:"_5-6-新组件一键接入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-新组件一键接入"}},[t._v("#")]),t._v(" 5.6. 新组件一键接入")]),t._v(" "),s("p",[t._v("新增组件只需要执行命令：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run new:comp\n")])])]),s("p",[t._v("然后交互式的输入组件英文名、中文名等内容即可。")]),t._v(" "),s("p",[t._v("为了维护方便，内部会有一个"),s("code",[t._v("component-config.json")]),t._v("文件，保存了所有的组件信息，包括名称、类型等。文档和示例的路由配置都是从这个文件生成。")]),t._v(" "),s("p",[t._v("这样的好处是要删除一个组件时，只要改变这个配置文件，然后执行"),s("code",[t._v("npm run gen:config")]),t._v("即可，同理，对于组件名称变动、类型变动也是一样的。")]),t._v(" "),s("p",[t._v("这个配置文件相当于一个收口，可以很方便的管理文档和示例。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeDocSidebar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeDemoIndexConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeDemoPagesJson")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeDemoTitleI18n")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("可以看出，这个配置主要驱动了：")]),t._v(" "),s("ul",[s("li",[t._v("文档的"),s("code",[t._v("sidebar")])]),t._v(" "),s("li",[t._v("示例的首页列表")]),t._v(" "),s("li",[t._v("示例的"),s("code",[t._v("pages.json")])]),t._v(" "),s("li",[t._v("示例的"),s("code",[t._v("i18n")]),t._v("配置")])]),t._v(" "),s("h3",{attrs:{id:"_5-7-类名兼容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-7-类名兼容"}},[t._v("#")]),t._v(" 5.7. 类名兼容")]),t._v(" "),s("p",[s("code",[t._v("press-ui")]),t._v("的类名前缀统一为"),s("code",[t._v("press-")]),t._v("，而"),s("code",[t._v("vant")]),t._v("的类名前缀为"),s("code",[t._v("van-")]),t._v("，对于老项目，"),s("code",[t._v("press-ui")]),t._v("提供了一种兼容方案，允许不改动之前的样式文件。")]),t._v(" "),s("p",[t._v("使用方式为，给组件添加一个属性："),s("code",[t._v('extra-class-prefix="van-"')]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"_5-8-api平滑升级方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-8-api平滑升级方案"}},[t._v("#")]),t._v(" 5.8. API平滑升级方案")]),t._v(" "),s("p",[t._v("组件API，可分为"),s("code",[t._v("props")]),t._v("和"),s("code",[t._v("event")]),t._v("。"),s("code",[t._v("event")]),t._v("的话直接多"),s("code",[t._v("emit")]),t._v("新的就好了，"),s("code",[t._v("props")]),t._v("的话需要先判断新旧"),s("code",[t._v("prop")]),t._v("的值是否为默认值。")]),t._v(" "),s("blockquote",[s("p",[t._v("如果哪一个不等则使用那一个，新"),s("code",[t._v("prop")]),t._v("优先级大于旧"),s("code",[t._v("prop")]),t._v("。如果都相等，就用新"),s("code",[t._v("prop")]),t._v("的值。")])]),t._v(" "),s("p",[t._v("注意，这里的相等不能是简单的"),s("code",[t._v("===")]),t._v("，需要考虑引用类型。")]),t._v(" "),s("p",[t._v("此外，还要考虑取子属性的场景，比如"),s("code",[t._v("this.a.b.c")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPropOrData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  isFunctionMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  functionModeData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  allProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  propsKeyMap "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  isFunctionMode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("boolean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  functionModeData"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Record"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  allProps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" PropType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  propsKeyMap"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Record"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  context"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isFunctionMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" oldKey "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" propsKeyMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 存在旧的key")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" oldDefaultValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDefaultValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("allProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" newDefaultValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDefaultValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("allProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isObjectEqual")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newDefaultValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findObjectDeepValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isObjectEqual")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("oldKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldDefaultValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findObjectDeepValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findObjectDeepValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findObjectDeepValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findObjectDeepValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("functionModeData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findObjectDeepValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Record"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" list "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("split")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" cur "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    cur "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cur"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("cur"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" cur"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_5-9-children循环引用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-9-children循环引用"}},[t._v("#")]),t._v(" 5.9. children循环引用")]),t._v(" "),s("p",[t._v("循环引用的对象不要放在"),s("code",[t._v("data/computed")]),t._v("中，直接在"),s("code",[t._v("created")]),t._v("中声明，比如"),s("code",[t._v("press-tabs")]),t._v("中的"),s("code",[t._v("children")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"_5-10-跨组件通信"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-10-跨组件通信"}},[t._v("#")]),t._v(" 5.10. 跨组件通信")]),t._v(" "),s("p",[s("code",[t._v("vant-weapp")]),t._v("用的是"),s("code",[t._v("reletion")]),t._v("，"),s("code",[t._v("press-ui")]),t._v("用的是"),s("code",[t._v("provide/inject")]),t._v("，也可以用"),s("code",[t._v("eventBus")]),t._v("。")])])}),[],!1,null,null,null);s.default=e.exports}}]);