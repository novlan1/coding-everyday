(window.webpackJsonp=window.webpackJsonp||[]).push([[260],{549:function(_,v,p){"use strict";p.r(v);var t=p(14),r=Object(t.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("ul",[v("li",[v("a",{attrs:{href:"#1-%E4%BA%A4%E5%8F%89%E7%86%B5"}},[_._v("1. 交叉熵")]),_._v(" "),v("ul",[v("li",[v("a",{attrs:{href:"#11-%E4%BF%A1%E6%81%AF%E9%87%8F"}},[_._v("1.1. 信息量")])]),_._v(" "),v("li",[v("a",{attrs:{href:"#12-%E7%86%B5"}},[_._v("1.2. 熵")])]),_._v(" "),v("li",[v("a",{attrs:{href:"#13-kl%E6%95%A3%E5%BA%A6%E7%9B%B8%E5%AF%B9%E7%86%B5"}},[_._v("1.3. KL散度（相对熵）")])]),_._v(" "),v("li",[v("a",{attrs:{href:"#14-%E4%BA%A4%E5%8F%89%E7%86%B5"}},[_._v("1.4. 交叉熵")])])])])]),_._v(" "),v("h2",{attrs:{id:"_1-交叉熵"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-交叉熵"}},[_._v("#")]),_._v(" 1. 交叉熵")]),_._v(" "),v("h3",{attrs:{id:"_1-1-信息量"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-信息量"}},[_._v("#")]),_._v(" 1.1. 信息量")]),_._v(" "),v("p",[_._v("假设我们听到了两件事，分别如下：")]),_._v(" "),v("ul",[v("li",[_._v("事件A：巴西队进入了2018世界杯决赛圈。")]),_._v(" "),v("li",[_._v("事件B：中国队进入了2018世界杯决赛圈。")])]),_._v(" "),v("p",[_._v("仅凭直觉来说，显而易见事件B的信息量比事件A的信息量要大。究其原因，是因为事件A发生的概率很大，事件B发生的概率很小。"),v("strong",[_._v("所以当越不可能的事件发生了，我们获取到的信息量就越大。越可能发生的事件发生了，我们获取到的信息量就越小")]),_._v("。那么"),v("strong",[_._v("信息量应该和事件发生的概率有关")]),_._v("。")]),_._v(" "),v("p",[_._v("假设X是一个离散型随机变量，其取值集合为χ, 概率分布函数p(x)=Pr(X=x), x∈χ, 则定义"),v("strong",[_._v("事件X=x0的信息量为：I(x0)=−log(p(x0))")])]),_._v(" "),v("p",[_._v("由于是概率所以p(x0)的取值范围是[0,1], 绘制为图形如下：")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.uwayfly.com/article_mike_20200531090803_96babf5d13b3.png",alt:"img"}})]),_._v(" "),v("p",[_._v("可见该函数符合我们对信息量的直觉")]),_._v(" "),v("h3",{attrs:{id:"_1-2-熵"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-熵"}},[_._v("#")]),_._v(" 1.2. 熵")]),_._v(" "),v("p",[_._v("假设小明的考试结果是一个0-1分布，XA只有两个取值{0：不及格，1：及格}，在某次考试结果公布前，小明的考试结果有多大的不确定度呢？\n你肯定会说：十有八九不及格！因为根据先验知识，"),v("strong",[_._v("小明及格的概率仅有0.1")]),_._v(", 90%的可能都是不及格的。\n怎么来度量这个不确定度？求期望！不错，我们对所有可能结果带来的额外信息量求取均值（期望），其结果不就能够衡量出小明考试成绩的不确定度了吗。")]),_._v(" "),v("p",[_._v("即："),v("code",[_._v("HA(x)=−[p(xA)log(p(xA))+(1−p(xA))log(1−p(xA))]=0.4690")])]),_._v(" "),v("p",[_._v("我们再假设一个成绩相对普通的学生小东，"),v("strong",[_._v("他及格的概率是P(xC)=0.5")]),_._v(",即及格与否的概率是一样的，对应的熵：")]),_._v(" "),v("p",[v("code",[_._v("HC(x)=−[p(xC)log(p(xC))+(1−p(xC))log(1−p(xC))]=1")])]),_._v(" "),v("p",[_._v("其熵为1，"),v("strong",[_._v("他的不确定性比前边两位同学要高很多")]),_._v("，在成绩公布之前，很难准确猜测出他的考试结果。")]),_._v(" "),v("p",[_._v("可以看出**，熵其实是信息量的期望值，它是一个随机变量的确定性的度量。熵越大，变量的取值越不确定，反之就越确定**。")]),_._v(" "),v("p",[_._v("对于一个随机变量X而言，它的所有可能取值的信息量的期望（E[I(x)]）就称为熵。")]),_._v(" "),v("p",[v("strong",[_._v("X的熵定义为：H(X)=Eplogp(x)=−∑p(x)logp(x)")])]),_._v(" "),v("p",[v("strong",[_._v("如果p(x)是连续型随机变量的pdf，则熵定义为："),v("code",[_._v("H(X)=−∫p(x)logp(x)dx")])])]),_._v(" "),v("p",[_._v("为了保证有效性，这里约定当p(x)→0时,有p(x)logp(x)→0")]),_._v(" "),v("p",[_._v("当X为0-1分布时，熵与概率p的关系如下图：")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.uwayfly.com/article_mike_20200531091914_0ca06da94716.png",alt:"img"}})]),_._v(" "),v("p",[_._v("可以看出，"),v("strong",[_._v("当两种取值的可能性相等时，不确定度最大（此时没有任何先验知识）")]),_._v("，这个结论可以推广到多种取值的情况。在图中也可以看出，"),v("strong",[_._v("当p=0或1时，熵为0，即此时X完全确定")]),_._v("。")]),_._v(" "),v("p",[v("strong",[_._v("熵的单位随着公式中log运算的底数而变化，当底数为2时，单位为“比特”(bit)，底数为e时，单位为“奈特”。")])]),_._v(" "),v("h3",{attrs:{id:"_1-3-kl散度-相对熵"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-kl散度-相对熵"}},[_._v("#")]),_._v(" 1.3. KL散度（相对熵）")]),_._v(" "),v("p",[v("strong",[_._v("相对熵(relative entropy)又称为KL散度（Kullback-Leibler divergence），KL距离")]),_._v("，是两个随机分布间距离的度量。记为"),v("code",[_._v("DKL(p||q)")]),_._v("。"),v("strong",[_._v("它度量当真实分布为p时，假设分布q的无效性")]),_._v("。")]),_._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[_._v("DKL(p||q) = Ep[logp(x)q(x)] = ∑p(x)logp(x)q(x)\n= ∑[p(x)logp(x)−p(x)logq(x)]\n= ∑p(x)logp(x)−∑p(x)logq(x)\n= −H(p)−∑p(x)logq(x)\n= −H(p)+Ep[−logq(x)]\n= Hp(q)−H(p)\n")])])]),v("p",[_._v("并且为了保证连续性，做如下约定：")]),_._v(" "),v("p",[v("code",[_._v("0log0=0")]),_._v("，"),v("code",[_._v("0logq=0")]),_._v("，"),v("code",[_._v("plogp0=∞")])]),_._v(" "),v("p",[_._v("显然，当p=q时, 两者之间的相对熵"),v("code",[_._v("DKL(p||q)=0")])]),_._v(" "),v("p",[v("strong",[_._v("上式最后的Hp(q)表示在p分布下，使用q进行编码需要的bit数")]),_._v("，"),v("strong",[_._v("而H(p)表示对真实分布p所需要的最小编码bit数")]),_._v("。基于此，相对熵的意义就很明确了："),v("strong",[_._v("DKL(p||q)表示在真实分布为p的前提下，使用q分布进行编码相对于使用真实分布p进行编码（即最优编码）所多出来的bit数")]),_._v("。")]),_._v(" "),v("h3",{attrs:{id:"_1-4-交叉熵"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-交叉熵"}},[_._v("#")]),_._v(" 1.4. 交叉熵")]),_._v(" "),v("p",[_._v("交叉熵容易跟相对熵搞混，二者联系紧密，但又有所区别。假设有两个分布p，q，则它们在给定样本集上的相对熵定义如下：")]),_._v(" "),v("p",[v("code",[_._v("CEH(p, q) = Ep[−logq] = −∑p(x)logq(x) = H(p) + DKL(p||q)")])]),_._v(" "),v("p",[_._v("可以看出，"),v("strong",[_._v("交叉熵与上一节定义的相对熵仅相差了H(p)")]),_._v(", "),v("strong",[_._v("当p已知时，可以把H(p)看做一个常数")]),_._v("，此时交叉熵与KL距离在行为上是等价的，都反映了分布p，q的相似程度。")]),_._v(" "),v("p",[v("strong",[_._v("最小化交叉熵等于最小化KL距离")]),_._v("。"),v("strong",[_._v("它们都将在p=q 时取得最小值H(p)（p=q时KL距离为0）")]),_._v("，因此有的工文献中将最小化KL距离的方法称为"),v("code",[_._v("Principle of Minimum Cross-Entropy")]),_._v(" (MCE)或Minxent方法。")])])}),[],!1,null,null,null);v.default=r.exports}}]);