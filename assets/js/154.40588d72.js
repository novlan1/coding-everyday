(window.webpackJsonp=window.webpackJsonp||[]).push([[154],{753:function(t,a,s){"use strict";s.r(a);var e=s(42),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("ul",[s("li",[s("a",{attrs:{href:"#1-%E8%BF%9B%E7%A8%8B"}},[t._v("1. 进程")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#11-%E4%B8%BB%E8%BF%9B%E7%A8%8B%E7%89%B9%E7%82%B9"}},[t._v("1.1. 主进程特点")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#2-ipc%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1"}},[t._v("2. IPC进程间通信")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#3-%E5%90%AF%E5%8A%A8%E5%91%BD%E4%BB%A4"}},[t._v("3. 启动命令")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#31-nodemon%E7%9B%91%E6%8E%A7%E6%9F%90%E4%BA%9B%E6%96%87%E4%BB%B6%E5%8F%98%E5%8A%A8%E8%87%AA%E5%8A%A8%E5%88%B7%E6%96%B0"}},[t._v("3.1. "),s("code",[t._v("nodemon")]),t._v("监控某些文件变动，自动刷新")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#4-api%E7%9B%B8%E5%85%B3"}},[t._v("4. API相关")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#41-parent-%E5%B1%9E%E6%80%A7"}},[t._v("4.1. parent 属性")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#42-nodeintegration"}},[t._v("4.2. "),s("code",[t._v("nodeIntegration")])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#43-loadurl"}},[t._v("4.3. "),s("code",[t._v("loadUrl")])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#44-%E4%B8%8A%E4%B8%8B%E6%96%87%E8%8F%9C%E5%8D%95-menumenuitem"}},[t._v("4.4. 上下文菜单 Menu、MenuItem")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#45-%E6%89%93%E5%BC%80%E5%AF%BC%E5%85%A5%E6%96%87%E4%BB%B6%E5%AF%B9%E8%AF%9D%E6%A1%86"}},[t._v("4.5. 打开导入文件对话框")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#46-%E6%89%93%E5%BC%80%E6%88%90%E5%8A%9F%E6%8F%90%E7%A4%BA%E4%BF%A1%E6%81%AF"}},[t._v("4.6. 打开成功提示信息")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#47-electron-%E6%89%93%E5%BC%80%E6%8E%A7%E5%88%B6%E5%8F%B0"}},[t._v("4.7. electron 打开控制台")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#48-%E4%B8%8A%E4%B8%8B%E6%96%87%E8%8F%9C%E5%8D%95"}},[t._v("4.8. 上下文菜单")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#49-%E8%AE%BE%E7%BD%AE%E5%8E%9F%E7%94%9F%E8%8F%9C%E5%8D%95"}},[t._v("4.9. 设置原生菜单")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#410-electron-%E7%9A%84-shell"}},[t._v("4.10. electron 的 shell")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#5-%E7%9B%B8%E5%85%B3%E6%8F%92%E4%BB%B6"}},[t._v("5. 相关插件")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#51-electron-store%E8%BF%9B%E8%A1%8C%E6%8C%81%E4%B9%85%E5%8C%96%E6%95%B0%E6%8D%AE"}},[t._v("5.1. "),s("code",[t._v("electron-store")]),t._v("进行持久化数据")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#52-electron-is-dev%E6%8F%92%E4%BB%B6"}},[t._v("5.2. "),s("code",[t._v("electron-is-dev")]),t._v("插件")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#53-%E5%AE%89%E8%A3%85devtron%E5%90%8E%E8%83%BD%E6%9F%A5%E7%9C%8Bipc%E9%80%9A%E4%BF%A1%E4%BF%A1%E6%81%AF"}},[t._v("5.3. 安装"),s("code",[t._v("devtron")]),t._v("后，能查看IPC通信信息")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#6-%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98"}},[t._v("6. 相关问题")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#61-%E7%94%A8windowrequire%E6%9B%BF%E4%BB%A3require"}},[t._v("6.1. 用"),s("code",[t._v("window.require")]),t._v("替代"),s("code",[t._v("require")])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#62-https-%E8%AF%81%E4%B9%A6%E4%B8%8D%E5%90%88%E6%B3%95%E6%97%B6-electron-%E4%BC%9A%E8%87%AA%E5%8A%A8%E9%80%80%E5%87%BA"}},[t._v("6.2. HTTPS 证书不合法时 ，electron 会自动退出")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#63-%E6%8F%90%E7%A4%BA%E8%B7%A8%E5%9F%9F"}},[t._v("6.3. 提示跨域")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#64-electron-builder%E6%89%93%E5%8C%85%E6%97%B6%E4%B8%8B%E8%BD%BD%E4%BE%9D%E8%B5%96%E5%A4%B1%E8%B4%A5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95"}},[t._v("6.4. "),s("code",[t._v("electron-builder")]),t._v("打包时下载依赖失败，解决方法")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#65-%E8%A7%A3%E5%86%B3-windows-%E4%B8%8B%E5%AE%89%E8%A3%85electron-800-%E5%9C%A8node-installjs%E5%8D%A1%E4%BD%8F%E7%9A%84%E9%97%AE%E9%A2%98"}},[t._v("6.5. 解决 Windows 下安装"),s("code",[t._v("electron 8.0.0")]),t._v(" 在"),s("code",[t._v("node install.js")]),t._v("卡住的问题")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#7-%E6%89%93%E5%8C%85"}},[t._v("7. 打包")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#71-%E6%89%93%E5%8C%85%E4%B8%AD%E7%9A%84%E5%9D%91"}},[t._v("7.1. 打包中的坑")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#72-%E6%89%93%E5%8C%85%E4%BD%93%E7%A7%AF%E4%BC%98%E5%8C%96"}},[t._v("7.2. 打包体积优化")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#73-electron-builder---dir%E5%92%8Celectron-builder%E7%9A%84%E4%B8%8D%E5%90%8C"}},[t._v("7.3. "),s("code",[t._v("electron-builder --dir")]),t._v("和"),s("code",[t._v("electron-builder")]),t._v("的不同")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#8-%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0"}},[t._v("8. 自动更新")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#9-%E5%9C%A8mainjs%E4%B8%AD%E4%BD%BF%E7%94%A8ipcmain%E7%9B%91%E5%90%AC%E4%BA%8B%E4%BB%B6%E4%B8%BA%E4%BB%80%E4%B9%88%E6%9C%89%E7%9A%84%E5%9C%B0%E6%96%B9%E5%8F%AF%E4%BB%A5%E7%94%A8eventsender%E5%8E%BB%E5%8F%91%E9%80%81%E4%BF%A1%E6%81%AF%E6%9C%89%E7%9A%84%E5%9C%B0%E6%96%B9%E5%8D%B4%E5%8F%AA%E8%83%BD%E7%94%A8mainwindow%E6%9D%A5%E5%8F%91%E9%80%81%E5%91%A2"}},[t._v("9. 在"),s("code",[t._v("main.js")]),t._v("中使用"),s("code",[t._v("ipcMain")]),t._v("监听事件，为什么有的地方可以用"),s("code",[t._v("event.sender")]),t._v("去发送信息，有的地方却只能用"),s("code",[t._v("mainWindow")]),t._v("来发送呢？")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#10-electron-%E9%95%9C%E5%83%8F%E5%9C%B0%E5%9D%80"}},[t._v("10. Electron 镜像地址")])])]),t._v(" "),s("h3",{attrs:{id:"_1-进程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-进程"}},[t._v("#")]),t._v(" 1. 进程")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("chrome")]),t._v("和"),s("code",[t._v("electron")]),t._v("一样，有一个主进程和多个渲染进程")]),t._v(" "),s("li",[t._v("每个渲染进程对应一个窗口")]),t._v(" "),s("li",[t._v("渲染进程能够调用 "),s("code",[t._v("DOM")]),t._v(" 的 "),s("code",[t._v("API")]),t._v(" 和 "),s("code",[t._v("node")]),t._v(" 的 "),s("code",[t._v("API")])]),t._v(" "),s("li",[t._v("主进程能调用 "),s("code",[t._v("node")]),t._v(" 的 "),s("code",[t._v("API")])])]),t._v(" "),s("h4",{attrs:{id:"_1-1-主进程特点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-主进程特点"}},[t._v("#")]),t._v(" 1.1. 主进程特点")]),t._v(" "),s("ul",[s("li",[t._v("支持"),s("code",[t._v("nodejs")]),t._v("；")]),t._v(" "),s("li",[t._v("只有一个，作为整个程序的入口点；")]),t._v(" "),s("li",[t._v("创建渲染进程；")]),t._v(" "),s("li",[t._v("可以使用和系统对接的"),s("code",[t._v("Eelectron API")]),t._v("，比如上传文件、创建菜单等。")])]),t._v(" "),s("h3",{attrs:{id:"_2-ipc进程间通信"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-ipc进程间通信"}},[t._v("#")]),t._v(" 2. IPC进程间通信")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("ipcRenderer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'msg'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nipcMain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'msg'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" arg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  ipcMain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reply")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'reply'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hi'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nipcMain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("emit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("‘msg’"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("’hi’"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-启动命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-启动命令"}},[t._v("#")]),t._v(" 3. 启动命令")]),t._v(" "),s("ul",[s("li",[t._v("使用"),s("code",[t._v("concurrently")]),t._v("同时运行"),s("code",[t._v("react")]),t._v("和"),s("code",[t._v("electron")]),t._v("，"),s("code",[t._v('concurrently \\"electron .\\" \\"npm start\\"')])]),t._v(" "),s("li",[t._v("使用"),s("code",[t._v("wait-on")]),t._v("插件，等待"),s("code",[t._v("localhost:3000")]),t._v("加载完之后，再运行"),s("code",[t._v("electron")])]),t._v(" "),s("li",[t._v("安装"),s("code",[t._v("cross-env")]),t._v("，不在浏览器中打开"),s("code",[t._v("localhost:3000")]),t._v("，"),s("code",[t._v("BROWSER=none")])])]),t._v(" "),s("p",[t._v("最后的命令为：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dev"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"concurrently \\"wait-on http://localhost:3000 && electron .\\"  \\"cross-env BROWSER=none npm start\\""')]),t._v("\n")])])]),s("h4",{attrs:{id:"_3-1-nodemon监控某些文件变动-自动刷新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-nodemon监控某些文件变动-自动刷新"}},[t._v("#")]),t._v(" 3.1. "),s("code",[t._v("nodemon")]),t._v("监控某些文件变动，自动刷新")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"onlyEle"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nodemon --watch main.js --watch ./src/utils/menuTemplate.js --exec \\"electron .\\" "')]),t._v("\n")])])]),s("p",[t._v("注意加上转义符号"),s("code",[t._v("\\")])]),t._v(" "),s("h3",{attrs:{id:"_4-api相关"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-api相关"}},[t._v("#")]),t._v(" 4. API相关")]),t._v(" "),s("h4",{attrs:{id:"_4-1-parent-属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-parent-属性"}},[t._v("#")]),t._v(" 4.1. parent 属性")]),t._v(" "),s("p",[t._v("从窗口增加 "),s("code",[t._v("parent")]),t._v(" 属性，作用是当父窗口关闭时，子窗口也跟着关闭。")]),t._v(" "),s("h4",{attrs:{id:"_4-2-nodeintegration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-nodeintegration"}},[t._v("#")]),t._v(" 4.2. "),s("code",[t._v("nodeIntegration")])]),t._v(" "),s("p",[s("code",[t._v("electron")]),t._v(" 项目中，"),s("code",[t._v("HTML")]),t._v(" 页面里面引用 "),s("code",[t._v("nodejs")]),t._v(" 的模块时缺报了错，提示 "),s("code",[t._v("require")]),t._v(" 未找到，原来是"),s("code",[t._v("electron")]),t._v(" 升级到"),s("code",[t._v("5.0")]),t._v("之后默认关闭了 "),s("code",[t._v("html")]),t._v(" 页面启用 "),s("code",[t._v("nodejs")]),t._v(" 环境的问题！")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("webPreferences"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  nodeIntegration"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_4-3-loadurl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-loadurl"}},[t._v("#")]),t._v(" 4.3. "),s("code",[t._v("loadUrl")])]),t._v(" "),s("p",[s("code",[t._v("electron")]),t._v(" 用 "),s("code",[t._v("loadUrl")]),t._v(" 当作 "),s("code",[t._v("loadFile")]),t._v(" 使用，需要加上"),s("code",[t._v("file://")]),t._v("协议符号")]),t._v(" "),s("h4",{attrs:{id:"_4-4-上下文菜单-menu、menuitem"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-上下文菜单-menu、menuitem"}},[t._v("#")]),t._v(" 4.4. 上下文菜单 Menu、MenuItem")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("menu "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Menu")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmenu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MenuItem")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  label"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Print'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  accelerator"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CmdOrCtrl+P'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("click")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'time to print stuff'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"_4-5-打开导入文件对话框"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-打开导入文件对话框"}},[t._v("#")]),t._v(" 4.5. 打开导入文件对话框")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("remote"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dialog"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("showOpenDialog")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  title"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  properties"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  filters"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("返回对象，包括 "),s("code",[t._v("canceled")]),t._v(" 和 "),s("code",[t._v("filepaths")])]),t._v(" "),s("h4",{attrs:{id:"_4-6-打开成功提示信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-打开成功提示信息"}},[t._v("#")]),t._v(" 4.6. 打开成功提示信息")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("remote"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dialog"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("showMessageBox")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'info'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  title"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  message"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"_4-7-electron-打开控制台"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-7-electron-打开控制台"}},[t._v("#")]),t._v(" 4.7. electron 打开控制台")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("mainWindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webContents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("openDevTools")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"_4-8-上下文菜单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-8-上下文菜单"}},[t._v("#")]),t._v(" 4.8. 上下文菜单")]),t._v(" "),s("p",[t._v("electron上下文菜单（右键菜单），需要先判断点击目标是否是文件"),s("code",[t._v("item")]),t._v("的子元素，然后响应"),s("code",[t._v("contextmenu")]),t._v("事件：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" menu "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Menu")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmenu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MenuItem")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmenu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("popup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" window"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" remote"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCurrentWindow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"_4-9-设置原生菜单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-9-设置原生菜单"}},[t._v("#")]),t._v(" 4.9. 设置原生菜单")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" menu "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildFromTemplate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("menuTemplate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nMenu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setApplicationMenu")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("在主进程中，还可以动态设置某些菜单是否禁用：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("submenu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("enabled "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n")])])]),s("h4",{attrs:{id:"_4-10-electron-的-shell"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-10-electron-的-shell"}},[t._v("#")]),t._v(" 4.10. electron 的 shell")]),t._v(" "),s("p",[t._v("可以用默认浏览器打开网页，可以打开文件夹")]),t._v(" "),s("h3",{attrs:{id:"_5-相关插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-相关插件"}},[t._v("#")]),t._v(" 5. 相关插件")]),t._v(" "),s("h4",{attrs:{id:"_5-1-electron-store进行持久化数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-electron-store进行持久化数据"}},[t._v("#")]),t._v(" 5.1. "),s("code",[t._v("electron-store")]),t._v("进行持久化数据")]),t._v(" "),s("p",[t._v("数据持久化，就是防止刷新就没了，比如数据库、"),s("code",[t._v("localStorage")]),t._v("、本地文件等")]),t._v(" "),s("h4",{attrs:{id:"_5-2-electron-is-dev插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-electron-is-dev插件"}},[t._v("#")]),t._v(" 5.2. "),s("code",[t._v("electron-is-dev")]),t._v("插件")]),t._v(" "),s("p",[s("code",[t._v("electron-is-dev")]),t._v("插件判断是开发环境还是线上")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" isDev "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron-is-dev'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"_5-3-安装devtron后-能查看ipc通信信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-安装devtron后-能查看ipc通信信息"}},[t._v("#")]),t._v(" 5.3. 安装"),s("code",[t._v("devtron")]),t._v("后，能查看IPC通信信息")]),t._v(" "),s("p",[t._v("代码：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'devtron'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-相关问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-相关问题"}},[t._v("#")]),t._v(" 6. 相关问题")]),t._v(" "),s("h4",{attrs:{id:"_6-1-用window-require替代require"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-用window-require替代require"}},[t._v("#")]),t._v(" 6.1. 用"),s("code",[t._v("window.require")]),t._v("替代"),s("code",[t._v("require")])]),t._v(" "),s("p",[s("code",[t._v("electron")]),t._v(" + "),s("code",[t._v("react")]),t._v("中无法使用"),s("code",[t._v("require")]),t._v("的原因是被"),s("code",[t._v("webpack")]),t._v("劫持了，在"),s("code",[t._v("node_modules")]),t._v("中去找了。")]),t._v(" "),s("p",[t._v("加上"),s("code",[t._v("window.require")]),t._v("后，可以把控制权交给"),s("code",[t._v("node.js")]),t._v("。")]),t._v(" "),s("h4",{attrs:{id:"_6-2-https-证书不合法时-electron-会自动退出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-https-证书不合法时-electron-会自动退出"}},[t._v("#")]),t._v(" 6.2. HTTPS 证书不合法时 ，electron 会自动退出")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'certificate-error'")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("，")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cb")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n  e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("preventDefault")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"_6-3-提示跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-提示跨域"}},[t._v("#")]),t._v(" 6.3. 提示跨域")]),t._v(" "),s("p",[t._v("渲染进程发送http请求，是从"),s("code",[t._v("file")]),t._v("协议上发的，提示跨域，需要设置：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("webPreferences"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n  webSecurity"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_6-4-electron-builder打包时下载依赖失败-解决方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-electron-builder打包时下载依赖失败-解决方法"}},[t._v("#")]),t._v(" 6.4. "),s("code",[t._v("electron-builder")]),t._v("打包时下载依赖失败，解决方法")]),t._v(" "),s("ol",[s("li",[t._v("在淘宝镜像上下载相应的包，"),s("code",[t._v("https://npm.taobao.org/mirrors/electron/")]),t._v("。按照包名下载")]),t._v(" "),s("li",[t._v("放到相应系统的缓存目录下。")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("macOS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ～"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Library"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Cache"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("electron"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("builder\nwindows"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("LOCALAPPDATA")]),t._v("\\electron"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("builder\\cache\n")])])]),s("h4",{attrs:{id:"_6-5-解决-windows-下安装electron-8-0-0-在node-install-js卡住的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-解决-windows-下安装electron-8-0-0-在node-install-js卡住的问题"}},[t._v("#")]),t._v(" 6.5. 解决 Windows 下安装"),s("code",[t._v("electron 8.0.0")]),t._v(" 在"),s("code",[t._v("node install.js")]),t._v("卡住的问题")]),t._v(" "),s("ol",[s("li",[t._v("卡在 "),s("code",[t._v("node install.js")]),t._v(" 时 "),s("code",[t._v("ctrl+c")]),t._v(" 退出进程")]),t._v(" "),s("li",[s("code",[t._v("cd node_modules/electron && code install.js")]),t._v(" （打开"),s("code",[t._v("install.js")]),t._v("）")]),t._v(" "),s("li",[t._v("修改代码如下:")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("mirrorOptions"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  mirror"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://npm.taobao.org/mirrors/electron/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  customDir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'8.0.0'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// customFilename:'electron-8.0.0-win32-x64.zip'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("这个方案在其他文章中也有所提及，只是版本不同，修改的参数不同了")]),t._v(" "),s("h3",{attrs:{id:"_7-打包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-打包"}},[t._v("#")]),t._v(" 7. 打包")]),t._v(" "),s("h4",{attrs:{id:"_7-1-打包中的坑"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-打包中的坑"}},[t._v("#")]),t._v(" 7.1. 打包中的坑")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("electron-builder")]),t._v("中把"),s("code",[t._v("react build")]),t._v("后的文件夹当成静态文件，不给打包，所以在配置的**"),s("code",[t._v("files")]),t._v("**字段中手动写入要打包的文件。 （提示错误为找不到"),s("code",[t._v("build/index.html")]),t._v("）\n1.1 "),s("code",[t._v("glob pattern")]),t._v(", 比如"),s("code",[t._v("build/**/*")]),t._v("，两个星号匹配所有子文件夹的文件，一个星号匹配当前文件夹下的所有文件。"),s("code",[t._v("**/*")]),t._v("就是当前目录下的所有文件。\n1.2 只要一设置"),s("code",[t._v("files")]),t._v("字段，默认配置就不生效了，所以必须全部写进去，包括"),s("code",[t._v("main.js")]),t._v("以及它依赖的文件和包。")]),t._v(" "),s("li",[t._v("修改"),s("code",[t._v("extends")]),t._v("属性为"),s("code",[t._v("null")]),t._v("，禁掉自动修改打包入口文件（应始终是"),s("code",[t._v("main.js")]),t._v("）（提示错误为找不到入口文件"),s("code",[t._v("build/electron.js")]),t._v("）。")]),t._v(" "),s("li",[t._v("在"),s("code",[t._v("package.json")]),t._v("中添加"),s("code",[t._v("homepage")]),t._v("为"),s("code",[t._v("'./'")]),t._v("，改为相对路径（提示错误为静态文件路径不对，"),s("code",[t._v("/static/css")]),t._v("、"),s("code",[t._v("/static/js")]),t._v("等）。")]),t._v(" "),s("li",[t._v("把所有在"),s("code",[t._v("main.js")]),t._v("中引用的插件，放到"),s("code",[t._v("dependencies")]),t._v("中去，否则会报错。")])]),t._v(" "),s("h4",{attrs:{id:"_7-2-打包体积优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-打包体积优化"}},[t._v("#")]),t._v(" 7.2. 打包体积优化")]),t._v(" "),s("ol",[s("li",[s("p",[s("code",[t._v("electron")]),t._v("打包时要把需要的包名称写到"),s("code",[t._v("package.jason")]),t._v("的"),s("code",[t._v("dependencies")]),t._v("中，"),s("code",[t._v("electron-builder")]),t._v("不会打包"),s("code",[t._v("devDependencies")]),t._v("中的包。\n所以一个优化的点就是将"),s("code",[t._v("main.js")]),t._v("中不需要的包移动到"),s("code",[t._v("devDependencies")]),t._v("中去。因为"),s("code",[t._v("react")]),t._v("已经将其他的打包过了，且是压缩的形式。打包后的"),s("code",[t._v("node_modules")]),t._v("文件夹就会变得很小。")])]),t._v(" "),s("li",[s("p",[t._v("用"),s("code",[t._v("webpack")]),t._v("将"),s("code",[t._v("main.js")]),t._v("及其依赖打包，就可以在配置的"),s("code",[t._v("files")]),t._v("中少写文件。同时要在配置中添加"),s("code",[t._v("extraMetadata")]),t._v("字段，以覆盖开发中的入口文件"),s("code",[t._v("main.js")])])])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"extraMetadata"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"main"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./build/main.js"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("p",[t._v("并且将"),s("code",[t._v("prepack")]),t._v("和"),s("code",[t._v("predist")]),t._v("改为"),s("code",[t._v("npm run build && npm run buildMain")]),t._v("，以及在"),s("code",[t._v("main.js")]),t._v("中把"),s("code",[t._v("loadUrl")]),t._v("路径更新。同时把"),s("code",[t._v("dependencies")]),t._v("更新，把"),s("code",[t._v("main.js")]),t._v("中使用的去掉。")]),t._v(" "),s("h4",{attrs:{id:"_7-3-electron-builder-dir和electron-builder的不同"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-electron-builder-dir和electron-builder的不同"}},[t._v("#")]),t._v(" 7.3. "),s("code",[t._v("electron-builder --dir")]),t._v("和"),s("code",[t._v("electron-builder")]),t._v("的不同")]),t._v(" "),s("ul",[s("li",[s("code",[t._v('"electron-builder --dir"')]),t._v(", 打包生成安装完毕后的文件")]),t._v(" "),s("li",[s("code",[t._v('"electron-builder"')]),t._v("，生成"),s("code",[t._v("dmg")]),t._v("、"),s("code",[t._v("exe")]),t._v("等源文件")])]),t._v(" "),s("h3",{attrs:{id:"_8-自动更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-自动更新"}},[t._v("#")]),t._v(" 8. 自动更新")]),t._v(" "),s("ol",[s("li",[t._v("自动发布"),s("code",[t._v("release")])])]),t._v(" "),s("p",[t._v("添加"),s("code",[t._v("publish")]),t._v("配置："),s("code",[t._v("[‘github’]")]),t._v("；增加命令"),s("code",[t._v("release")]),t._v("，和"),s("code",[t._v("dist")]),t._v("指令相同，不过它会自动发布一个"),s("code",[t._v("release")]),t._v("；同时增加指令"),s("code",[t._v("prerelease")]),t._v("，和"),s("code",[t._v("predist")]),t._v("相同。")]),t._v(" "),s("p",[t._v("如果更新到"),s("code",[t._v("github")]),t._v("需要"),s("code",[t._v("token")]),t._v("，所以完整命令为:")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[t._v("“release”： "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cross-env GH_TOKEN=123 electron-builder"')]),t._v("\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("添加自动更新功能")])]),t._v(" "),s("p",[t._v("安装"),s("code",[t._v("electron-updater")]),t._v("，比"),s("code",[t._v("electron")]),t._v("内置的更新配置简单。")]),t._v(" "),s("h3",{attrs:{id:"_9-在main-js中使用ipcmain监听事件-为什么有的地方可以用event-sender去发送信息-有的地方却只能用mainwindow来发送呢"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-在main-js中使用ipcmain监听事件-为什么有的地方可以用event-sender去发送信息-有的地方却只能用mainwindow来发送呢"}},[t._v("#")]),t._v(" 9. 在"),s("code",[t._v("main.js")]),t._v("中使用"),s("code",[t._v("ipcMain")]),t._v("监听事件，为什么有的地方可以用"),s("code",[t._v("event.sender")]),t._v("去发送信息，有的地方却只能用"),s("code",[t._v("mainWindow")]),t._v("来发送呢？")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("mainWindow")]),t._v("指定发送，而"),s("code",[t._v("event.sender")]),t._v("进程内回调发送。")]),t._v(" "),s("li",[t._v("就是一个页面内发信息发送到"),s("code",[t._v("main.js")]),t._v("，然后用"),s("code",[t._v("event.sender")]),t._v("进行进程内在发送回去。")]),t._v(" "),s("li",[t._v("而"),s("code",[t._v("mainwindow")]),t._v("实际上是新建的一个进程窗口，我们就指定给他发送了。")])]),t._v(" "),s("h3",{attrs:{id:"_10-electron-镜像地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_10-electron-镜像地址"}},[t._v("#")]),t._v(" 10. Electron 镜像地址")]),t._v(" "),s("p",[t._v("https://npm.taobao.org/mirrors/electron/")])])}),[],!1,null,null,null);a.default=n.exports}}]);