
[toc]

近期做需求中有一些感想，在这里记录下。

## 1. 产品究竟是谁的

人人都是产品经理，并不是一句口号，每个人都是用户，即便你是研发、设计、测试，都有无数的时间，和世界上最优秀的产品打交道。最优秀的产品包括你的电脑、手机，和那些最流行的APP。

所以，如果某个产品经理一言堂，那这个产品大概率不会太成功。除非他真的厉害，并且有数据支撑，比如乔布斯这种。产品不是政治，产品是可以讨论的。

如果一些交互设计难以理解，研发都用着费劲，怎么在普通人中推广呢？

另一个问题，研发需要了解并思考产品的逻辑吗？

答案肯定是需要的，产品是有逻辑的，研发可以根据产品的逻辑，判断、预测未来的变化，抽出稳定性更强的代码。

一个工作3年和工作10年的研发的一个区别就在于，对于产品逻辑的理解，大概工作更久的人更容易预测产品未来的变化，会在代码编写、结构设计时就拆分出不变与变化，从而让代码更易维护。但是，如果每次新来一个需求，都从0开始，从不思考，就另当别论了。


## 2. 定制与通用

通用和定制往往是对立的，一个需求如果是定制的，意味着不够通用。

前一阵做了一个国际化的需求，国际化其实就代表通用，本地化代表定制。

但是如果同一类型定制的多了，就可以变为通用需求。本质上一个`string/number`类型总是可以扩展成`array`的。

比如H5的自动化测试报告处理，和小程序的处理，是可以通用化的。

这给我们一个启示是，要多沉淀东西，做过的那么多需求，比如表单系统、权限系统，这些工作即使一两年内不会重复，但是时间拉长来，总会在职业生涯的某个阶段重新做一次。

还有，我们加班那么多，是不是产品设计、需求提出、技术实现的时候，通用性考虑的就不足呢，所以今天在A上拧一个螺丝，明天在B上拧一个螺丝。

可怕的是，这两个螺丝都是一样的残次品。

通用性在不同的层次上有不同的表现，比如总监可以考虑业务的通用，产品经理考虑产品的通用，开发则考虑代码和系统层面的。

组件化的基础也是通用性，如果一个组件可以被复用，说明它是通用的。

## 3. 字段名

发现一个现象，大家在字段命名的时候比较洒脱。

- 格式比较多样，比如角色Id：`roleId`、`role_id`、`roleid`，子活动Id：`childid`、`child_id`、`childId`。
- 名称也多样，比如手机号：`phone`、`mobile`，头像：`head`、`header`。

大家好像习惯了这种乱七八糟的命名，倘若统一了，反而觉得难受。

在其他地方没得到的自由，终于在命名时得到了。

这种字段命名问题和上面的通用化有些关系，如果不能统一，谈何通用呢，通用化的基础一定是标准化。

为什么大家会在命名时候，这么随意呢？大概率是因为他根本没考虑过下游开发者的感受，比如CGI层、前端。

下游开发者做起来是很痛苦的，他知道这个协议会包含子活动Id，但是他必须去协议页面查看，才能知道究竟是哪种命名，是`childid`、还是`childId`、还是`child_id`？并且，他在向他的下游或下级页面、组件传递时，需要考虑对方需要的是什么，必须做一层转换。如果他不知道转换或者不想转换，让下游直接修改字段名，那整个项目就更“精彩”了。


## 4. 代码是资产还是负债

总看到有人说，代码是负债，个人不敢苟同，倘若代码都是负债，你还在这敲锤子啊，岂不是越欠越多？

大部分人之所以认为代码是负债，是因为维护起来费劲，一看代码就头疼，每次改代码都像是上刀山，这能不是负债吗。

所以，个人认为，代码质量高的代码是资产，写的像X一样的是负债。

“大处着眼，小处着手”，架构、系统相关可以视为“大处”，代码规范、代码质量可以视为“小处”。

最近看到公共基础库很多很多的魔法字符串，开发没有意识去抽离，维护这样的代码就比较头疼了。

甚至有人说，“单元测试有什么用？“

## 5. 兜底

有一个需求，A类型的奖品不需要展示，B类型的奖品可以展示，后台让前端“兜底”，过滤下这个类型的奖品。

想到这个只是产品的上层逻辑，是极容易变化的，今天屏蔽A、明天屏蔽B，后天可能又要放开A、B。

兜底应该是对边界的兼容，比如多重`if else`中最后的`else`，或者对空值给默认值，或者对解析失败的捕获，像这种产品上的逻辑怎么会是兜底呢？这种过滤其实是数据层面的处理，越在上游处理越简单，因为用数据的地方总是无法控制的。

这其实反映出另一个问题，前后台责任不明确，这次你帮我多处理一下，下次我帮你多处理一下。本来后台该做的事，放到前端来做，下一次，本来前端该兼容的，让后台来做。

前端应该始终兼容空值边界，比如`a.b.c`，当`b`属性不存在时候的异常。组件、页面总是可能复用的，如果下个`prop`或者`cgi`没传，就要付出额外的时间成本处理错误。

此外，处理数据的逻辑应该放在一起，如果这里增加一点字段、那里改变一下结构，又没有类型提示的话，后期维护起来很难受。

